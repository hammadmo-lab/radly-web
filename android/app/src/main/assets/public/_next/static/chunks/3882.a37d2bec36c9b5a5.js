"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3882],{11186:(e,t,a)=>{a.d(t,{bq:()=>x,eb:()=>g,gC:()=>h,l6:()=>c,yv:()=>m});var r=a(95155),s=a(12115),i=a(18261),l=a(24033),n=a(12108),d=a(5917),o=a(64269);let c=i.bL;i.YJ;let m=i.WT,x=s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.jsxs)(i.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[s,(0,r.jsx)(i.In,{asChild:!0,children:(0,r.jsx)("span",{children:(0,r.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})})]})});x.displayName=i.l9.displayName;let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(n.A,{className:"h-4 w-4"})})});p.displayName=i.PP.displayName;let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})});u.displayName=i.wn.displayName;let h=s.forwardRef((e,t)=>{let{className:a,children:s,position:l="popper",...n}=e;return(0,r.jsx)(i.ZL,{children:(0,r.jsxs)(i.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...n,children:[(0,r.jsx)(p,{}),(0,r.jsx)(i.LM,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(u,{})]})})});h.displayName=i.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.JU,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})}).displayName=i.JU.displayName;let g=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(i.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(i.VF,{children:(0,r.jsx)(d.A,{className:"h-4 w-4"})})}),(0,r.jsx)(i.p4,{children:s})]})});g.displayName=i.q7.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=i.wv.displayName},31120:(e,t,a)=>{a.d(t,{T:()=>l});var r=a(95155),s=a(12115),i=a(64269);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...s})});l.displayName="Textarea"},46767:(e,t,a)=>{a.d(t,{Bc:()=>n,ZI:()=>c,k$:()=>o,m_:()=>d});var r=a(95155),s=a(12115),i=a(47520),l=a(64269);let n=i.Kq,d=i.bL,o=s.forwardRef((e,t)=>(0,r.jsx)(i.l9,{ref:t,...e}));o.displayName=i.l9.displayName;let c=s.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...n}=e;return(0,r.jsx)(i.UC,{ref:t,sideOffset:s,className:(0,l.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})});c.displayName=i.UC.displayName},51834:(e,t,a)=>{a.d(t,{Cf:()=>p,Es:()=>h,L3:()=>g,c7:()=>u,lG:()=>d,rr:()=>f,zM:()=>o});var r=a(95155),s=a(12115),i=a(89511),l=a(65229),n=a(64269);let d=i.bL,o=s.forwardRef((e,t)=>(0,r.jsx)(i.l9,{ref:t,...e}));o.displayName=i.l9.displayName;let c=i.ZL,m=s.forwardRef((e,t)=>(0,r.jsx)(i.bm,{ref:t,...e}));m.displayName=i.bm.displayName;let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.hJ,{ref:t,className:(0,n.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});x.displayName=i.hJ.displayName;let p=s.forwardRef((e,t)=>{let{className:a,children:s,...d}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(x,{}),(0,r.jsxs)(i.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...d,children:[s,(0,r.jsxs)(m,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(l.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});p.displayName=i.UC.displayName;let u=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};u.displayName="DialogHeader";let h=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};h.displayName="DialogFooter";let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",a),...s})});g.displayName=i.hE.displayName;let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});f.displayName=i.VY.displayName},62785:(e,t,a)=>{a.d(t,{Q:()=>o});var r=a(95155),s=a(12115),i=a(52619),l=a.n(i),n=a(65993),d=a(27937);function o(e){let{items:t}=e;return(0,r.jsxs)("nav",{"aria-label":"Breadcrumb",className:"flex items-center gap-2 text-sm text-muted-foreground mb-4",children:[(0,r.jsx)(l(),{href:"/app/dashboard",className:"flex items-center justify-center hover:text-foreground transition-colors","aria-label":"Go to dashboard",children:(0,r.jsx)(n.A,{className:"h-4 w-4"})}),t.map((e,a)=>{let i=a===t.length-1;return(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)(d.A,{className:"h-4 w-4 flex-shrink-0","aria-hidden":"true"}),e.href&&!i?(0,r.jsx)(l(),{href:e.href,className:"hover:text-foreground transition-colors whitespace-nowrap leading-none flex items-center",children:e.label}):(0,r.jsx)("span",{className:"whitespace-nowrap leading-none flex items-center ".concat(i?"text-foreground font-medium":""),"aria-current":i?"page":void 0,children:e.label})]},a)})]})}},65142:(e,t,a)=>{a.d(t,{p:()=>d});var r=a(95155),s=a(12115),i=a(83101),l=a(64269);let n=(0,i.F)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"),d=s.forwardRef((e,t)=>{let{className:a,type:s,...i}=e;return(0,r.jsx)("input",{type:s,className:(0,l.cn)(n(),a),ref:t,...i})});d.displayName="Input"},74832:(e,t,a)=>{function r(e){if(!e)return"/app/dashboard";try{let t=window.location.origin,a=new URL(e,t);if(a.origin!==t)return"/app/dashboard";let r=a.pathname+(a.search||"");return r.startsWith("/")?r:"/app/dashboard"}catch(e){return"/app/dashboard"}}function s(e){let t=encodeURIComponent(e||"/app/dashboard");return"/signin?next=".concat(t)}a.d(t,{n:()=>r,q:()=>s})},76444:(e,t,a)=>{a.d(t,{J:()=>o});var r=a(95155),s=a(12115),i=a(10489),l=a(83101),n=a(64269);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.b,{ref:t,className:(0,n.cn)(d(),a),...s})});o.displayName=i.b.displayName},86948:(e,t,a)=>{a.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>l,aR:()=>n});var r=a(95155),s=a(12115),i=a(64269);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});l.displayName="Card";let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...s})});n.displayName="CardHeader";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});d.displayName="CardTitle";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})});o.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},91162:(e,t,a)=>{a.d(t,{Sk:()=>s,b6:()=>i,eU:()=>l});var r=a(13077);async function s(e){try{var t,a,s;let i=await (0,r.getSupabaseClient)(),{data:{user:l},error:n}=await i.auth.getUser();if(n||!l)throw Error("User not found");return{id:e,email:l.email||"",default_signature_name:(null==(t=l.user_metadata)?void 0:t.default_signature_name)||"",default_signature_date_format:(null==(a=l.user_metadata)?void 0:a.default_signature_date_format)||"MM/DD/YYYY",accepted_terms_at:null==(s=l.user_metadata)?void 0:s.accepted_terms_at,subscription:null,updated_at:l.updated_at||new Date().toISOString()}}catch(t){return{id:e,email:"",default_signature_name:"",default_signature_date_format:"MM/DD/YYYY",subscription:null,updated_at:new Date().toISOString()}}}async function i(e,t){try{let e=await (0,r.getSupabaseClient)(),{error:a}=await e.auth.updateUser({data:{default_signature_name:t.default_signature_name,default_signature_date_format:t.default_signature_date_format,accepted_terms_at:t.accepted_terms_at}});if(a)throw Error("Failed to update user data: ".concat(a.message))}catch(e){throw e}}let l={retry:(e,t)=>!(t.message.includes("401")||t.message.includes("403")||t.message.includes("404"))&&e<2,retryDelay:e=>Math.min(1e3*2**e,3e4),staleTime:3e5}},93882:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Q,dynamic:()=>H});var r=a(95155),s=a(12115),i=a(20063),l=a(22544),n=a(66942),d=a(22454),o=a(1733),c=a(26497),m=a(3998),x=a(86948),p=a(65142),u=a(31120),h=a(76444),g=a(11186),f=a(54879);let b=f.Ik({name:f.Yj().trim().optional(),mrn:f.Yj().trim().optional(),age:f.vk(e=>""===e||void 0===e?void 0:Number(e),f.ai({required_error:"Patient age is required",invalid_type_error:"Please enter a valid age"}).int("Age must be a whole number").positive("Age must be greater than 0").max(130,"Please enter a valid age (maximum 130)")),sex:f.k5(["M","F","O"],{required_error:"Please select the patient's sex",invalid_type_error:"Please select a valid option"})}),j=f.Ik({name:f.Yj().optional(),date:f.Yj().optional()}),N=f.Ik({templateId:f.Yj().min(1,"Template is required"),includePatient:f.zM().default(!0),patient:b,indication:f.Yj().trim().min(1,"Indication/history is required"),findings:f.Yj().trim().min(1,"Findings are required"),technique:f.Yj().trim().optional(),signature:j.default({name:"",date:""})});var y=a(25656),v=a(51056),w=a(74832),_=a(18720),F=a(35299),k=a(6132),C=a(89715),R=a(20508),S=a(7744),D=a(57828),A=a(35626),E=a(48314),P=a(42529),I=a(90368),q=a(27937),T=a(8971),L=a(18927),U=a(91162),z=a(62785),M=a(46767),Y=a(80021),B=a(73272),J=a(16421),$=a(39142),O=a(56154),V=a(26983),G=a(51834);let K={free:{maxDuration:60,dailyLimit:0,maxConcurrentStreams:3,hasAccess:!0,isTrial:!0,trialLimit:3},starter:{maxDuration:0,dailyLimit:0,maxConcurrentStreams:0,hasAccess:!1},professional:{maxDuration:180,dailyLimit:100,maxConcurrentStreams:10,hasAccess:!0},premium:{maxDuration:300,dailyLimit:300,maxConcurrentStreams:15,hasAccess:!0}};function W(e){let{open:t,onClose:a,currentTier:s,reason:i,onUpgrade:l}=e,{title:n,description:d,icon:o}=(()=>{switch(i){case"trial_exhausted":return{title:"Free Trial Completed",description:"You've used your 3 free voice dictation trials. Upgrade to Professional or Premium to continue using this powerful feature.",icon:(0,r.jsx)($.A,{className:"h-12 w-12 text-primary"})};case"tier_blocked":return{title:"Premium Feature",description:"Voice dictation is available for Professional and Premium plans. Upgrade to unlock this feature and speed up your report generation.",icon:(0,r.jsx)(O.A,{className:"h-12 w-12 text-yellow-500"})};case"daily_limit":return{title:"Daily Limit Reached",description:"You've reached your daily transcription limit. Upgrade to Premium for higher limits and longer recording times.",icon:(0,r.jsx)(V.A,{className:"h-12 w-12 text-orange-500"})}}})(),c="free"===s||"starter"===s?"professional":"premium",x=K[c],p=["".concat(x.dailyLimit," transcriptions per day"),"Up to ".concat(Math.floor(x.maxDuration/60)," minutes per recording"),"".concat(x.maxConcurrentStreams," concurrent streams"),"Medical terminology optimized","Real-time transcription","No trial limits"];return(0,r.jsx)(G.lG,{open:t,onOpenChange:a,children:(0,r.jsxs)(G.Cf,{className:"sm:max-w-[500px]",children:[(0,r.jsxs)(G.c7,{children:[(0,r.jsx)("div",{className:"flex justify-center mb-4",children:o}),(0,r.jsx)(G.L3,{className:"text-center text-2xl",children:n}),(0,r.jsx)(G.rr,{className:"text-center text-base pt-2",children:d})]}),(0,r.jsx)("div",{className:"py-4",children:(0,r.jsxs)("div",{className:"bg-primary/5 border border-primary/20 rounded-lg p-4",children:[(0,r.jsxs)("h4",{className:"font-semibold text-lg mb-3 capitalize flex items-center gap-2",children:[(0,r.jsx)(O.A,{className:"h-5 w-5 text-primary"}),c," Plan"]}),(0,r.jsx)("ul",{className:"space-y-2",children:p.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-start gap-2 text-sm",children:[(0,r.jsx)(P.A,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),(0,r.jsx)("span",{children:e})]},t))})]})}),"professional"===s&&"premium"===c&&(0,r.jsxs)("div",{className:"text-sm text-muted-foreground text-center pb-2",children:["Your current Professional plan gives you ",K.professional.dailyLimit," ","transcriptions per day. Upgrade to Premium for"," ",K.premium.dailyLimit," per day."]}),(0,r.jsxs)(G.Es,{className:"flex gap-2 sm:gap-2",children:[(0,r.jsx)(m.$,{variant:"outline",onClick:a,className:"flex-1",children:"Maybe Later"}),(0,r.jsxs)(m.$,{onClick:l,className:"flex-1",children:["Upgrade to ",c]})]})]})})}var Z=a(64269);let H="force-dynamic";function Q(){var e,t,a,f;let b=(0,i.useRouter)(),j=(0,i.useSearchParams)(),{userId:$}=(0,T.L)(),{user:O}=(0,L.A)(),V=function(e){let t=t=>{if(e instanceof URLSearchParams)return e.get(t)||void 0;let a=e[t];return Array.isArray(a)?a[0]:a};for(let e of["template","templateId","template_id","templated","templte","tid"]){let a=t(e);if(a)return String(a)}}(j),[G,K]=(0,s.useState)(1),[H,Q]=(0,s.useState)(!1),[X,ee]=(0,s.useState)(null),[et,ea]=(0,s.useState)(!1),[er,es]=(0,s.useState)(!1),[ei,el]=(0,s.useState)("tier_blocked"),[en,ed]=(0,s.useState)("free"),{data:eo,isLoading:ec,error:em}=(0,d.I)({queryKey:["template",V],queryFn:async()=>{if(!V)return null;try{let e=await (0,y.lx)("/v1/template/".concat(V)),t=e&&(e.title||e.name||e.display_name||e.label)||"(Untitled Template)";return{...e,templateTitle:t}}catch(e){if(e instanceof Error&&e.message.includes("401")){let e=window.location.pathname+window.location.search;return window.location.href=(0,w.q)(e),null}throw e}},enabled:!!V}),{data:ex}=(0,d.I)({queryKey:["profile",null==O?void 0:O.id],queryFn:async()=>O?{...await (0,U.Sk)(O.id),email:O.email||""}:null,enabled:!!O,...U.eU}),{data:ep}=(0,d.I)({queryKey:["subscription-usage"],queryFn:()=>(0,y.lx)("/v1/subscription/usage"),enabled:!!O}),{register:eu,handleSubmit:eh,watch:eg,setValue:ef,reset:eb,trigger:ej,formState:{errors:eN,isDirty:ey,isSubmitting:ev}}=(0,l.mN)({resolver:(0,n.u)(N),mode:"onBlur",reValidateMode:"onChange",defaultValues:{templateId:V||"",includePatient:!0,patient:{name:"",mrn:"",age:void 0,sex:void 0},indication:"",findings:"",technique:"",signature:{name:"",date:new Date().toLocaleDateString()}}}),{restoreDraft:ew,clearDraft:e_}=function(e){let{key:t,watch:a,setValue:r,enabled:i=!0}=e,l="form-draft-".concat(t);(0,s.useEffect)(()=>{if(!i)return;let e=a(e=>{try{Object.values(e).some(e=>"string"==typeof e?e.trim().length>0:"object"==typeof e&&null!==e?Object.values(e).some(e=>"string"==typeof e?e.trim().length>0:!!e):!!e)&&localStorage.setItem(l,JSON.stringify({data:e,timestamp:Date.now()}))}catch(e){}});return()=>e.unsubscribe()},[a,l,i]);let n=(0,s.useCallback)(()=>{if(!i)return null;try{let e=localStorage.getItem(l);if(!e)return null;let{data:t,timestamp:a}=JSON.parse(e);if(Date.now()-a>864e5)return localStorage.removeItem(l),null;return{data:t,timestamp:a,age:Date.now()-a}}catch(e){return null}},[l,i]);return{restoreDraft:n,applyDraft:(0,s.useCallback)(e=>{e&&Object.entries(e).forEach(e=>{let[t,a]=e;r(t,a,{shouldValidate:!1})})},[r]),clearDraft:(0,s.useCallback)(()=>{try{localStorage.removeItem(l)}catch(e){}},[l])}}({key:"generate-".concat(V||"default"),watch:eg,setValue:ef,enabled:!0}),[eF,ek]=(0,s.useState)(!1),[eC,eR]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=ew();e&&e.data&&(eR(e.data),ek(!0))},[ew]),(0,s.useEffect)(()=>{if(ex){let e=ex.default_signature_date_format?new Date().toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,ex.default_signature_date_format.includes("/")?"/":"-"):new Date().toLocaleDateString();eb({templateId:V||"",includePatient:!0,patient:{name:"",mrn:"",age:void 0,sex:void 0},indication:"",findings:"",technique:"",signature:{name:ex.default_signature_name||"",date:e}})}},[ex,eb,V]),(0,s.useEffect)(()=>{ea(!1)},[G]),(0,s.useEffect)(()=>{let e=e=>{if(ey&&!ev)return e.preventDefault(),e.returnValue="",""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[ey,ev]);let eS=(0,s.useCallback)(async()=>{if(1===G)return void K(2);if(2===G)return await ej(["patient.age","patient.sex"],{shouldFocus:!0})?void K(3):void _.oR.error("Please complete the required patient details before continuing.");if(3===G){if(!await ej(["indication","findings"],{shouldFocus:!0}))return void _.oR.error("Clinical information is required to continue.");K(4)}},[G,ej]),eD=(0,s.useCallback)(()=>{K(e=>Math.max(1,e-1))},[]),eA=(0,s.useCallback)(e=>{let t=(eg("findings")||"").trimEnd();ef("findings","".concat(t).concat(t?"\n\n":"").concat(e),{shouldValidate:!0,shouldDirty:!0})},[eg,ef]),eE=(0,s.useCallback)(e=>{_.oR.error(e),(e.includes("trial")||e.includes("upgrade")||e.includes("Starter"))&&(e.includes("trial")?el("trial_exhausted"):e.includes("daily limit")?el("daily_limit"):el("tier_blocked"),es(!0))},[]),eP=(0,s.useCallback)(e=>{ed(e),el("tier_blocked"),es(!0)},[]);(0,s.useEffect)(()=>{V||b.replace("/app/templates")},[V,b]),(0,s.useEffect)(()=>{V&&localStorage.setItem("recent-template-id",V)},[V]),(0,s.useEffect)(()=>{let e=eo&&"object"==typeof eo&&null!==eo&&"templateTitle"in eo&&"string"==typeof eo.templateTitle?eo.templateTitle:null;V&&e&&localStorage.setItem("recent-template-name",e)},[V,eo]);let eI=eo&&"object"==typeof eo?eo:{};if(!V)return(0,r.jsx)("div",{className:"flex min-h-[60vh] items-center justify-center p-6",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-3 text-center text-muted-foreground",children:[(0,r.jsx)(F.A,{className:"h-6 w-6 animate-spin"}),(0,r.jsx)("p",{children:"Redirecting you to Templates…"})]})});if(ec)return(0,r.jsx)("div",{className:"flex min-h-[60vh] items-center justify-center p-6",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-3 text-center text-muted-foreground",children:[(0,r.jsx)(F.A,{className:"h-6 w-6 animate-spin"}),(0,r.jsx)("p",{children:"Loading template details…"})]})});if(em)return(0,r.jsx)("div",{className:"flex min-h-[60vh] items-center justify-center p-6",children:(0,r.jsxs)("div",{className:"aurora-card w-full max-w-md border border-[rgba(255,107,107,0.35)] bg-[rgba(255,107,107,0.12)] p-6 text-center",children:[(0,r.jsx)(k.A,{className:"mx-auto mb-3 h-8 w-8 text-[#FFD1D1]"}),(0,r.jsx)("h2",{className:"mb-2 text-lg font-semibold text-white",children:"Unable to load template"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(255,209,209,0.8)]",children:"We couldn't load the selected template. It may have been removed or you may no longer have access."}),(0,r.jsxs)("div",{className:"mt-4 flex justify-center gap-3",children:[(0,r.jsx)(m.$,{variant:"ghost",onClick:()=>b.push("/app/templates"),className:"rounded-xl border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.75)] px-5 text-[rgba(207,207,207,0.85)] hover:border-[rgba(75,142,255,0.45)] hover:bg-[rgba(75,142,255,0.18)] hover:text-white",children:"Browse templates"}),(0,r.jsx)(m.$,{variant:"ghost",onClick:()=>window.location.reload(),className:"rounded-xl border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.75)] px-5 text-[rgba(207,207,207,0.85)] hover:border-[rgba(75,142,255,0.45)] hover:bg-[rgba(75,142,255,0.18)] hover:text-white",children:"Retry"})]})]})});let eq=async e=>{if(4===G&&et){if((null==ep?void 0:ep.subscription)&&ep.subscription.reports_used>=ep.subscription.reports_limit){ee("You have reached your monthly report limit. Please upgrade your plan or wait for the next billing cycle."),_.oR.error("Usage limit reached. Please upgrade to continue generating reports.");return}Q(!0),ee(null);try{var t;let a={name:e.patient.name||void 0,mrn:e.patient.mrn||void 0,age:null!=(t=e.patient.age)?t:void 0,sex:e.patient.sex||void 0},r={templateId:V||e.templateId,indication:e.indication,findings:e.findings,impression:e.indication,technique:e.technique,patient:a,signature:e.signature},s=(await (0,v.Ix)(r)).job_id;e_(),(0,B.L)();try{if($){let e="radly_recent_jobs_local_".concat($),t=JSON.parse(localStorage.getItem(e)||"[]");t.unshift({job_id:s,status:"queued",template_id:r.templateId,title:"Generating…",created_at:Date.now()}),localStorage.setItem(e,JSON.stringify(t))}}catch(e){}sessionStorage.setItem("radly:lastJobId",s),_.oR.success("Report generation started!"),b.push("/app/report/".concat(s))}catch(t){let e="Failed to start report generation";if(t&&"object"==typeof t&&"status"in t){let a=t.status;if(401===a){_.oR.error("Session expired. Please sign in again.");let e=window.location.pathname+window.location.search;window.location.href=(0,w.q)(e);return}403===a?e="You don't have permission to generate reports. Please check your subscription.":429===a?e="Too many requests. Please wait a moment and try again.":404===a?e="Template not found. Please select a different template.":a>=500&&(e="Server error. Please try again in a few moments.")}t instanceof Error&&(t.message.includes("quota")||t.message.includes("limit"))&&(e="Monthly report limit reached. Please upgrade your plan to continue."),t instanceof Error&&(t.message.includes("fetch")||t.message.includes("network"))&&(e="Network error. Please check your connection and try again."),t instanceof Error&&t.message&&t.message.length>10&&(e=t.message),ee(e),_.oR.error(e)}finally{Q(!1)}}},eT=[{id:1,name:"Template",icon:C.A},{id:2,name:"Patient Info",icon:R.A},{id:3,name:"Clinical Data",icon:S.A},{id:4,name:"Review",icon:D.A}];return(0,r.jsx)("div",{className:"min-h-screen bg-[var(--ds-bg-gradient)] text-white",children:(0,r.jsxs)("main",{className:"mx-auto max-w-5xl space-y-6 sm:space-y-8 px-4 sm:px-6 py-10 sm:py-12 pb-28",children:[(0,r.jsx)(z.Q,{items:[{label:"Templates",href:"/app/templates"},{label:"Generate Report"}]}),(0,r.jsxs)("div",{className:"neon-shell space-y-6 p-6 sm:p-8 md:p-10 backdrop-blur-xl",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(m.$,{variant:"ghost",onClick:()=>b.push("/app/templates"),className:"gap-2 text-[rgba(207,207,207,0.78)] hover:text-white","aria-label":"Go back to templates",children:[(0,r.jsx)(A.A,{className:"w-4 h-4"}),"Back"]}),(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl font-semibold text-white",children:"Generate Report"}),(0,r.jsx)("div",{className:"w-24"})]}),(0,r.jsx)(x.Zp,{className:"aurora-card border border-[rgba(255,255,255,0.08)] text-white",children:(0,r.jsxs)(x.Wu,{className:"p-4 sm:p-6",children:[(0,r.jsx)("div",{className:"flex sm:hidden justify-center gap-2 mb-4",children:eT.map(e=>(0,r.jsx)(o.P.div,{className:"h-2 rounded-full transition-all ".concat(G>=e.id?"bg-[linear-gradient(90deg,#2653FF_0%,#4B8EFF_50%,#8F82FF_100%)] w-8":"bg-[rgba(207,207,207,0.25)] w-6"),layout:!0},e.id))}),(0,r.jsxs)("div",{className:"hidden sm:flex items-center justify-between relative",children:[(0,r.jsx)("div",{className:"absolute top-6 left-0 right-0 h-0.5 bg-[rgba(207,207,207,0.18)]",children:(0,r.jsx)(o.P.div,{className:"h-full bg-[linear-gradient(90deg,#2653FF_0%,#4B8EFF_60%,#8F82FF_100%)]",animate:{width:"".concat((G-1)/(eT.length-1)*100,"%")},transition:{duration:.3}})}),(0,r.jsx)("div",{className:"relative z-10 flex w-full items-center justify-between",children:eT.map(e=>{let t=G===e.id,a=G>e.id;return(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)("div",{className:(0,Z.cn)("flex h-14 w-14 items-center justify-center rounded-full border transition-all",t||a?"border-[rgba(75,142,255,0.45)] bg-[linear-gradient(135deg,#2653FF,#8F82FF)] text-white shadow-[0_18px_42px_rgba(31,64,175,0.4)]":"border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.85)] text-[rgba(207,207,207,0.5)]"),children:(0,r.jsx)(e.icon,{className:"h-6 w-6"})}),(0,r.jsx)("span",{className:(0,Z.cn)("text-xs uppercase tracking-[0.18em] text-[rgba(207,207,207,0.5)]",t&&"text-white"),children:e.name})]},e.id)})})]})]})})]}),eF&&eC&&(0,r.jsx)("div",{className:"aurora-card border border-[rgba(75,142,255,0.35)] bg-[rgba(75,142,255,0.12)] p-4 sm:p-5 rounded-2xl",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[(0,r.jsx)(E.A,{className:"h-5 w-5 text-[#4B8EFF] flex-shrink-0 mt-0.5"}),(0,r.jsx)("p",{className:"text-sm sm:text-base text-white break-words",children:"We found a saved draft from your previous session. Would you like to restore it?"})]}),(0,r.jsxs)("div",{className:"flex gap-2 sm:gap-3 sm:flex-shrink-0",children:[(0,r.jsx)(m.$,{size:"sm",variant:"ghost",onClick:()=>{ek(!1),eR(null),e_()},className:"flex-1 sm:flex-none min-h-[44px] rounded-lg border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.78)] text-[rgba(207,207,207,0.85)] hover:border-[rgba(255,255,255,0.3)] hover:text-white",children:"Discard"}),(0,r.jsx)(m.$,{size:"sm",onClick:()=>{Object.entries(eC).forEach(e=>{let[t,a]=e;ef(t,a,{shouldValidate:!1})}),ek(!1),_.oR.success("Draft restored successfully")},className:"flex-1 sm:flex-none min-h-[44px] rounded-lg bg-[linear-gradient(90deg,#2653FF_0%,#4B8EFF_100%)] text-white shadow-[0_12px_28px_rgba(75,142,255,0.32)]",children:"Restore"})]})]})}),X&&(0,r.jsx)("div",{className:"rounded-2xl border border-[rgba(255,107,107,0.35)] bg-[rgba(255,107,107,0.12)] p-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(k.A,{className:"h-5 w-5 text-[#FFD1D1]"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-white",children:"Error"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(255,209,209,0.85)]",children:X})]})]})}),(null==ep?void 0:ep.subscription)&&ep.subscription.reports_used>=ep.subscription.reports_limit&&(0,r.jsx)(x.Zp,{className:"aurora-card border border-[rgba(255,107,107,0.35)] bg-[rgba(255,107,107,0.12)]",children:(0,r.jsx)(x.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(k.A,{className:"h-5 w-5 text-[#FFD1D1] flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"mb-1 text-base font-semibold text-white",children:"Monthly Limit Reached"}),(0,r.jsxs)("p",{className:"mb-3 text-sm text-[rgba(255,209,209,0.8)]",children:["You have used ",ep.subscription.reports_used," of ",ep.subscription.reports_limit," reports this month. Upgrade your plan to continue generating reports immediately."]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(m.$,{size:"sm",onClick:()=>b.push("/pricing"),className:"rounded-lg bg-[linear-gradient(90deg,#FF6B6B_0%,#FF9F6B_100%)] px-4 text-white shadow-[0_12px_28px_rgba(255,107,107,0.32)]",children:"Upgrade Plan"}),(0,r.jsx)(m.$,{size:"sm",variant:"ghost",onClick:()=>b.push("/app/dashboard"),className:"rounded-lg border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.78)] px-4 text-[rgba(207,207,207,0.85)] hover:border-[rgba(255,255,255,0.3)] hover:text-white",children:"Back to Dashboard"})]})]})]})})}),(0,r.jsxs)("form",{onSubmit:eh(eq),className:"space-y-6",onKeyDown:e=>{if("Enter"!==e.key)return;let t=e.target;!(t instanceof HTMLTextAreaElement||t instanceof HTMLButtonElement)&&(e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||t instanceof HTMLInputElement&&"submit"!==t.type&&e.preventDefault())},children:[(0,r.jsx)(c.N,{mode:"wait",children:(0,r.jsxs)(o.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[1===G&&(0,r.jsxs)("div",{className:"aurora-card border border-[rgba(255,255,255,0.08)] overflow-hidden",children:[(0,r.jsx)("div",{className:"border-b border-[rgba(255,255,255,0.08)] bg-[rgba(12,16,28,0.78)] px-4 sm:px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-[linear-gradient(135deg,#2653FF,#8F82FF)] shadow-[0_14px_32px_rgba(31,64,175,0.35)] flex-shrink-0",children:(0,r.jsx)(C.A,{className:"h-5 w-5 text-white"})}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-white",children:"Template Selection"}),(0,r.jsx)("p",{className:"text-xs sm:text-sm text-[rgba(207,207,207,0.65)]",children:"Confirm the template you're using for this report."})]})]})}),(0,r.jsx)("div",{className:"p-4 sm:p-6 md:p-8",children:(0,r.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,r.jsxs)("div",{className:"rounded-2xl border border-[rgba(75,142,255,0.3)] bg-[rgba(12,16,28,0.65)] p-5 sm:p-6 text-center",children:[(0,r.jsx)("h3",{className:"text-xl sm:text-2xl font-semibold text-white mb-4",children:eI.templateTitle||"(Untitled Template)"}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-2 text-xs sm:text-sm text-[#D7E3FF] mb-6",children:[eI.modality&&(0,r.jsx)("span",{className:"rounded-full bg-[rgba(75,142,255,0.18)] px-3 py-1.5 font-semibold",children:eI.modality}),eI.body_system&&(0,r.jsx)("span",{className:"rounded-full bg-[rgba(75,142,255,0.18)] px-3 py-1.5 font-semibold",children:eI.body_system}),eI.anatomy&&(0,r.jsx)("span",{className:"rounded-full bg-[rgba(75,142,255,0.18)] px-3 py-1.5 font-semibold",children:eI.anatomy})]}),(0,r.jsx)(m.$,{variant:"ghost",size:"sm",className:"rounded-lg border border-[rgba(255,255,255,0.12)] bg-[rgba(18,22,36,0.72)] px-5 py-2 text-[rgba(207,207,207,0.8)] hover:border-[rgba(75,142,255,0.45)] hover:bg-[rgba(75,142,255,0.18)] hover:text-white min-h-[44px]",onClick:()=>b.push("/app/templates"),children:"Change template"})]})})})]}),2===G&&(0,r.jsxs)("div",{className:"aurora-card border border-[rgba(255,255,255,0.08)] overflow-hidden",children:[(0,r.jsx)("div",{className:"border-b border-[rgba(255,255,255,0.08)] bg-[rgba(12,16,28,0.78)] px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-[linear-gradient(135deg,#3FBF8C,#6EE7B7)] text-white shadow-[0_14px_32px_rgba(63,191,140,0.35)]",children:(0,r.jsx)(R.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Patient Information"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(207,207,207,0.65)]",children:"Provide patient details (age and sex are required)."})]})]})}),(0,r.jsx)("div",{className:"space-y-4 p-5 sm:p-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"patient.name",className:"text-[rgba(207,207,207,0.75)]",children:"Patient Name (optional)"}),(0,r.jsx)(p.p,{id:"patient.name",inputMode:"text",autoCapitalize:"words",autoComplete:"name",...eu("patient.name"),placeholder:"John Doe",className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)] input-mobile"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"patient.mrn",className:"text-[rgba(207,207,207,0.75)]",children:"Medical Record Number (optional)"}),(0,r.jsx)(p.p,{id:"patient.mrn",inputMode:"text",autoCapitalize:"characters",autoCorrect:"off",...eu("patient.mrn"),placeholder:"MRN123456",className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)] input-mobile"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"patient.age",className:"text-[rgba(207,207,207,0.75)]",children:"Age (required)"}),(0,r.jsx)(p.p,{id:"patient.age",type:"number",inputMode:"numeric",pattern:"[0-9]*",...eu("patient.age",{valueAsNumber:!0}),placeholder:"45",className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)] input-mobile"}),(null==(e=eN.patient)?void 0:e.age)&&(0,r.jsx)("p",{className:"text-sm text-[#FF9F9F]",children:eN.patient.age.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"patient.sex",className:"text-[rgba(207,207,207,0.75)]",children:"Sex (required)"}),(0,r.jsxs)(g.l6,{value:eg("patient.sex")||"",onValueChange:e=>ef("patient.sex",e,{shouldValidate:!0}),children:[(0,r.jsx)(g.bq,{id:"patient.sex",className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white focus:border-[rgba(75,142,255,0.45)]",children:(0,r.jsx)(g.yv,{placeholder:"Select sex"})}),(0,r.jsxs)(g.gC,{className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,14,24,0.95)] text-white",children:[(0,r.jsx)(g.eb,{value:"M",children:"Male"}),(0,r.jsx)(g.eb,{value:"F",children:"Female"}),(0,r.jsx)(g.eb,{value:"O",children:"Other"})]})]}),(null==(t=eN.patient)?void 0:t.sex)&&(0,r.jsx)("p",{className:"text-sm text-[#FF9F9F]",children:eN.patient.sex.message})]})]})})]}),3===G&&(0,r.jsxs)("div",{className:"aurora-card border border-[rgba(255,255,255,0.08)] overflow-hidden",children:[(0,r.jsx)("div",{className:"border-b border-[rgba(255,255,255,0.08)] bg-[rgba(12,16,28,0.78)] px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-[linear-gradient(135deg,#4B8EFF,#8F82FF)] text-white shadow-[0_14px_32px_rgba(31,64,175,0.35)]",children:(0,r.jsx)(S.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Clinical Information"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(207,207,207,0.65)]",children:"Provide the clinical details for the report."})]})]})}),(0,r.jsx)(M.Bc,{children:(0,r.jsxs)("div",{className:"space-y-4 p-5 sm:p-6 sm:space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(h.J,{htmlFor:"indication",className:"text-[rgba(207,207,207,0.75)]",children:"Indication / Clinical history (required)"}),(0,r.jsxs)(M.m_,{children:[(0,r.jsx)(M.k$,{asChild:!0,children:(0,r.jsx)("button",{className:"inline-flex items-center justify-center",type:"button",children:(0,r.jsx)(Y.A,{className:"h-4 w-4 text-muted-foreground cursor-help"})})}),(0,r.jsx)(M.ZI,{className:"max-w-xs",children:(0,r.jsx)("p",{children:"The clinical reason for ordering this study. Include relevant symptoms, prior diagnoses, or follow-up information."})})]})]}),(0,r.jsx)(u.T,{id:"indication",inputMode:"text",autoCapitalize:"sentences",...eu("indication"),placeholder:"Reason for study...",rows:3,className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)] textarea-mobile"}),eN.indication&&(0,r.jsx)("p",{className:"text-sm text-[#FF9F9F]",children:eN.indication.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(h.J,{htmlFor:"findings",className:"text-[rgba(207,207,207,0.75)]",children:"Findings (required)"}),(0,r.jsxs)(M.m_,{children:[(0,r.jsx)(M.k$,{asChild:!0,children:(0,r.jsx)("button",{className:"inline-flex items-center justify-center",type:"button",children:(0,r.jsx)(Y.A,{className:"h-4 w-4 text-muted-foreground cursor-help"})})}),(0,r.jsx)(M.ZI,{className:"max-w-xs",children:(0,r.jsx)("p",{children:"Your radiological observations. Can be bulleted or free text. This will be organized into the findings section of the report."})})]})]}),eN.findings&&(0,r.jsxs)("p",{className:"text-sm text-[#FF9F9F] flex items-center gap-1.5",children:[(0,r.jsx)(k.A,{className:"h-4 w-4 flex-shrink-0"}),eN.findings.message]}),(0,r.jsx)(u.T,{id:"findings",inputMode:"text",autoCapitalize:"sentences",...eu("findings"),placeholder:"Enter your findings here. You can type bullet points, write in free text format, or use voice dictation.",rows:6,className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)] textarea-mobile"}),(0,r.jsx)("p",{className:"text-xs text-[rgba(207,207,207,0.45)]",children:"Tip: Press Enter for a new line, or use the Voice Dictation button below for hands-free input."}),(0,r.jsx)(J.z,{onTranscript:eA,onError:eE,onUpgradeRequired:eP,disabled:H})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"technique",className:"text-[rgba(207,207,207,0.75)]",children:"Technique (optional)"}),(0,r.jsx)(p.p,{id:"technique",inputMode:"text",autoCapitalize:"sentences",...eu("technique"),placeholder:"Portal venous phase...",className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)] input-mobile"})]})]})})]}),4===G&&(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"aurora-card border border-[rgba(255,255,255,0.08)] overflow-hidden",children:[(0,r.jsx)("div",{className:"border-b border-[rgba(255,255,255,0.08)] bg-[rgba(12,16,28,0.78)] px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-[linear-gradient(135deg,#F8B74D,#FF6B6B)] text-white shadow-[0_14px_32px_rgba(255,155,80,0.35)]",children:(0,r.jsx)(P.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Review & Submit"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(207,207,207,0.65)]",children:"Review your information before generating the report."})]})]})}),(0,r.jsxs)("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"signature.name",className:"text-[rgba(207,207,207,0.75)]",children:"Signature Name"}),(0,r.jsx)(p.p,{id:"signature.name",...eu("signature.name"),placeholder:"Dr. Jane Smith",className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)]",onKeyDown:e=>{"Enter"===e.key&&e.preventDefault()}}),(null==(a=eN.signature)?void 0:a.name)&&(0,r.jsx)("p",{className:"text-sm text-[#FF9F9F]",children:eN.signature.name.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"signature.date",className:"text-[rgba(207,207,207,0.75)]",children:"Date"}),(0,r.jsx)(p.p,{id:"signature.date",...eu("signature.date"),placeholder:new Date().toLocaleDateString(),className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)]",onKeyDown:e=>{"Enter"===e.key&&e.preventDefault()}}),(null==(f=eN.signature)?void 0:f.date)&&(0,r.jsx)("p",{className:"text-sm text-[#FF9F9F]",children:eN.signature.date.message})]})]}),(0,r.jsxs)("div",{className:"mt-6 rounded-2xl border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.65)] p-6",children:[(0,r.jsx)("h4",{className:"mb-4 text-lg font-semibold text-white",children:"Report Summary"}),(0,r.jsxs)("div",{className:"space-y-3 text-sm text-[rgba(207,207,207,0.7)]",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-white font-medium",children:"Template:"}),(0,r.jsx)("p",{className:"mt-1",children:eI.templateTitle||"(Untitled Template)"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-white font-medium",children:"Patient Data:"}),(0,r.jsx)("p",{className:"mt-1",children:"Included"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-white font-medium",children:"Indication:"}),(0,r.jsx)("p",{className:"mt-1 whitespace-pre-wrap break-words",children:eg("indication")||"Not provided"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-white font-medium",children:"Findings:"}),(0,r.jsx)("p",{className:"mt-1 whitespace-pre-wrap break-words",children:eg("findings")||"Not provided"})]})]})]}),(0,r.jsx)("div",{className:"mt-6 rounded-2xl border border-[rgba(75,142,255,0.35)] bg-[rgba(12,16,28,0.6)] p-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(P.A,{className:"h-5 w-5 text-[#7AE7B4]"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-white",children:"Ready to Generate"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(207,207,207,0.7)]",children:"Review the details above and click “Generate Report” when you're ready."})]})]})})]})]})})]},G)}),(0,r.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 mt-6 flex items-center justify-between bg-[rgba(6,10,18,0.98)] backdrop-blur-md px-4 py-3 text-white md:static md:bg-transparent md:p-0 md:mt-6 z-20 safe-area-inset-bottom",children:[(0,r.jsx)(m.$,{type:"button",variant:"ghost",onClick:eD,disabled:1===G,className:(0,Z.cn)("flex items-center justify-center rounded-full w-12 h-12 bg-[rgba(18,22,36,0.8)] border border-[rgba(255,255,255,0.12)] text-white hover:bg-[rgba(75,142,255,0.2)] hover:border-[rgba(75,142,255,0.4)] transition-all",1===G&&"opacity-40 cursor-not-allowed"),"aria-label":"Previous step",children:(0,r.jsx)(I.A,{className:"w-6 h-6"})}),(0,r.jsx)("div",{className:"flex items-center gap-3",children:G<4?(0,r.jsx)(m.$,{type:"button",onClick:eS,className:"flex items-center justify-center rounded-full w-12 h-12 bg-[#2653FF] hover:bg-[#4B8EFF] text-white transition-all","aria-label":"Next step",children:(0,r.jsx)(q.A,{className:"w-6 h-6"})}):(0,r.jsx)(m.$,{type:"submit",disabled:H||ev||(null==ep?void 0:ep.subscription)&&ep.subscription.reports_used>=ep.subscription.reports_limit,className:"flex items-center justify-center gap-2 rounded-full px-6 h-12 bg-[#3FBF8C] hover:bg-[#6EE7B7] text-white font-semibold transition-all disabled:opacity-60",onClick:()=>{ea(!0)},children:H||ev?"Generating...":"Generate Report"})})]})]}),(0,r.jsx)(W,{open:er,onClose:()=>es(!1),currentTier:en,reason:ei,onUpgrade:()=>{es(!1),b.push("/pricing")}}),(H||ev)&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-[rgba(4,8,18,0.95)] backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"relative w-full max-w-md mx-4 rounded-3xl border border-[rgba(75,142,255,0.3)] bg-gradient-to-br from-[rgba(12,16,28,0.98)] to-[rgba(5,8,16,0.95)] px-8 py-10 text-center shadow-2xl",children:[(0,r.jsx)("div",{className:"absolute inset-0 rounded-3xl bg-gradient-to-br from-[rgba(75,142,255,0.08)] to-transparent opacity-50 pointer-events-none"}),(0,r.jsxs)("div",{className:"relative space-y-6",children:[(0,r.jsx)("div",{className:"mx-auto flex h-20 w-20 items-center justify-center rounded-full border border-[rgba(75,142,255,0.3)] bg-[rgba(12,16,28,0.9)] shadow-lg",children:(0,r.jsx)("div",{className:"h-12 w-12 rounded-full border-3 border-[rgba(143,130,255,0.3)] border-t-[rgba(143,130,255,0.9)] animate-spin",style:{borderWidth:"3px"}})}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-widest text-[rgba(207,207,207,0.5)]",children:"Assistant at work"}),(0,r.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold text-white",children:"Generating your radiology report"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(207,207,207,0.75)] max-w-sm mx-auto",children:"Radly is aligning findings, impressions, and follow-up recommendations. You'll review the draft in just a moment."})]})]})]})})]})})}}}]);