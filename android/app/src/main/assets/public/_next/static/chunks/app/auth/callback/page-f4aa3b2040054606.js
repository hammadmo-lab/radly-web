(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6769],{13077:(e,t,i)=>{"use strict";i.d(t,{AG:()=>c});var s=i(11993),a=i(16010),n=i(32587),r=i(4077);class o{static getInstance(){return o.instance||(o.instance=new o),o.instance}async initialize(){if(!this.initialized)return this.initializationPromise||(this.initializationPromise=this._doInitialize()),this.initializationPromise}async _doInitialize(){try{if(!n.Ii.isNativePlatform()){this.initialized=!0;return}let{keys:e}=await r.Preferences.keys();for(let t of e.filter(e=>e.startsWith(this.STORAGE_PREFIX)))try{let{value:e}=await r.Preferences.get({key:t});if(e){let i=t.substring(this.STORAGE_PREFIX.length);this.cache.set(i,e)}}catch(e){}this.initialized=!0}catch(e){this.initialized=!0}}getItem(e){return this.initialized&&this.cache.get(e)||null}setItem(e,t){this.initialized&&(this.cache.set(e,t),this._persistToStorage(e,t).catch(e=>{}))}removeItem(e){this.initialized&&(this.cache.delete(e),this._removeFromStorage(e).catch(e=>{}))}async _persistToStorage(e,t){if(!n.Ii.isNativePlatform())return;let i=this.STORAGE_PREFIX+e;try{await r.Preferences.set({key:i,value:t})}catch(e){throw e}}async _removeFromStorage(e){if(!n.Ii.isNativePlatform())return;let t=this.STORAGE_PREFIX+e;try{await r.Preferences.remove({key:t})}catch(e){throw e}}async clear(){if(this.cache.clear(),n.Ii.isNativePlatform())try{let{keys:e}=await r.Preferences.keys();for(let t of e.filter(e=>e.startsWith(this.STORAGE_PREFIX)))await r.Preferences.remove({key:t})}catch(e){}}getDebugInfo(){return{initialized:this.initialized,cacheSize:this.cache.size,cachedKeys:Array.from(this.cache.keys()),platform:n.Ii.isNativePlatform()?"capacitor":"web",prefix:this.STORAGE_PREFIX}}constructor(){this.cache=new Map,this.initialized=!1,this.initializationPromise=null,this.STORAGE_PREFIX="sb-"}}async function c(){if(i.g.__supabase_client&&i.g.__supabase_client_initialized)return i.g.__supabase_client;if(i.g.__supabase_client_initialized){let e=0;for(;!i.g.__supabase_client&&e<50;)await new Promise(e=>setTimeout(e,100)),e++;if(i.g.__supabase_client)return i.g.__supabase_client;throw Error("Supabase client initialization timeout")}i.g.__supabase_client_initialized=!0;try{let e,t,n=(()=>{var e;let t=window.Capacitor;return!!(null==t||null==(e=t.isNativePlatform)?void 0:e.call(t))})();if(n){let e=o.getInstance();await e.initialize(),t=function(){let e=o.getInstance();return e.initialize().catch(e=>{}),{getItem:t=>e.getItem(t),setItem:(t,i)=>e.setItem(t,i),removeItem:t=>e.removeItem(t)}}()}return e=n?(0,s.UU)("https://bsldtgivgtyzacwyvcfh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJzbGR0Z2l2Z3R5emFjd3l2Y2ZoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MzQ1NzMsImV4cCI6MjA3NTUxMDU3M30.vjHPo6WEASxYBOAGYmZ93o5n9RhZvANSlLhaT-wagTs",{auth:{storage:t,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!1,debug:!0}}):(0,a.createBrowserClient)("https://bsldtgivgtyzacwyvcfh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJzbGR0Z2l2Z3R5emFjd3l2Y2ZoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MzQ1NzMsImV4cCI6MjA3NTUxMDU3M30.vjHPo6WEASxYBOAGYmZ93o5n9RhZvANSlLhaT-wagTs",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!1,flowType:"pkce",debug:!1}}),i.g.__supabase_client=e,e.__isSingleton=!0,e.__createdAt=new Date().toISOString(),e.__platform=n?"capacitor":"web",e}catch(e){throw i.g.__supabase_client_initialized=!1,e}}void 0===i.g&&(globalThis.global=globalThis)},53992:(e,t,i)=>{Promise.resolve().then(i.bind(i,87756))},87756:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>c});var s=i(95155),a=i(12115),n=i(20063),r=i(13077),o=i(88899);function c(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)(),[i,c]=(0,a.useState)("loading"),[l,h]=(0,a.useState)("");return(0,a.useEffect)(()=>{(async()=>{let i=t.get("code"),s=t.get("error"),a=t.get("error_description"),n=t.get("access_token"),l=t.get("refresh_token"),u=t.get("expires_in"),d=window.location.hash?new URLSearchParams(window.location.hash.substring(1)):null,m=null==d?void 0:d.get("access_token"),f=null==d?void 0:d.get("refresh_token"),g=null==d?void 0:d.get("expires_in"),_=n||m||void 0,p=l||f||void 0,I=!!_||!!p;if(s){c("error"),h(a||s),setTimeout(()=>e.push("/auth/signin"),3e3);return}if(!i&&!I){c("error"),h("Missing authorization code"),setTimeout(()=>e.push("/auth/signin"),3e3);return}try{let t=await (0,r.AG)();if(i){let{error:e}=await t.auth.exchangeCodeForSession(i);if(e)throw e}else{if(!_)throw Error("Authentication failed: missing access token");if(!p)throw Error("Authentication failed: missing refresh token");let{data:e,error:i}=await t.auth.setSession({access_token:_,refresh_token:p});if(i)throw i;if(!e.session)throw Error("Authentication failed: session not returned");window.location.hash&&window.history.replaceState({},document.title,"".concat(window.location.pathname).concat(window.location.search))}c("success");let{next:s}=(0,o.oO)(),a=s||"/app/dashboard";(0,o.aL)(),setTimeout(()=>{e.push(a)},500)}catch(t){c("error"),h(t instanceof Error?t.message:"Authentication failed"),setTimeout(()=>e.push("/auth/signin"),3e3)}})()},[t,e]),(0,s.jsxs)("div",{className:"flex min-h-screen items-center justify-center flex-col gap-4 p-4",children:["loading"===i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-lg font-medium",children:"Completing sign in..."}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Please wait"})]}),"success"===i&&(0,s.jsx)("div",{className:"text-lg font-medium text-green-600",children:"Sign in successful! Redirecting..."}),"error"===i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-lg font-medium text-red-600",children:"Sign in failed"}),(0,s.jsx)("div",{className:"text-sm text-red-500 text-center max-w-md",children:l}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Redirecting to login..."})]})]})}},88899:(e,t,i)=>{"use strict";i.d(t,{aL:()=>o,iB:()=>n,oO:()=>r});let s="auth_origin",a="auth_next";function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/app/dashboard",t=window.location.origin;document.cookie="".concat(s,"=").concat(encodeURIComponent(t),"; path=/; max-age=").concat(600,"; SameSite=Lax"),document.cookie="".concat(a,"=").concat(encodeURIComponent(e),"; path=/; max-age=").concat(600,"; SameSite=Lax")}function r(e){let t=t=>{if(e){let i=e.split(";").map(e=>e.trim()).find(e=>e.startsWith("".concat(t,"=")));return i?decodeURIComponent(i.split("=")[1]):null}if("undefined"!=typeof document){let e=document.cookie.split(";").map(e=>e.trim()).find(e=>e.startsWith("".concat(t,"=")));if(e)return decodeURIComponent(e.split("=")[1])}return null};return{origin:t(s),next:t(a)}}function o(){"undefined"!=typeof document&&(document.cookie="".concat(s,"=; path=/; max-age=0"))}}},e=>{e.O(0,[6010,72,8441,1255,7358],()=>e(e.s=53992)),_N_E=e.O()}]);