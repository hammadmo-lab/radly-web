(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8164],{18927:(e,t,a)=>{"use strict";a.d(t,{O:()=>d,A:()=>c});var r=a(95155),s=a(12115),i=a(88727),n=a(90260);function l(){try{let e=(0,i.createBrowserClient)("https://bsldtgivgtyzacwyvcfh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJzbGR0Z2l2Z3R5emFjd3l2Y2ZoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MzQ1NzMsImV4cCI6MjA3NTUxMDU3M30.vjHPo6WEASxYBOAGYmZ93o5n9RhZvANSlLhaT-wagTs");if((0,n.Wj)()){let t=(0,n.Ld)();return{...e,auth:{...e.auth,getSession:async()=>({data:{session:t},error:null}),getUser:async()=>({data:{user:(null==t?void 0:t.user)||null},error:null}),signOut:async()=>({error:null}),onAuthStateChange:e=>(e("SIGNED_IN",t),{data:{subscription:{unsubscribe:()=>{}}}})}}}return e}catch(e){return{auth:{getSession:async()=>({data:{session:null},error:null}),getUser:async()=>({data:{user:null},error:null}),signOut:async()=>({error:null}),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}})}}}}let o=(0,s.createContext)(void 0);function d(e){let{children:t}=e,[i,n]=(0,s.useState)(null),[d,c]=(0,s.useState)(null),[m,u]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=l();e.auth.getSession().then(e=>{var t;let{data:{session:a}}=e;c(a),n(null!=(t=null==a?void 0:a.user)?t:null),u(!1)}).catch(e=>{c(null),n(null),u(!1)});let{data:{subscription:t}}=e.auth.onAuthStateChange((e,t)=>{var a;c(t),n(null!=(a=null==t?void 0:t.user)?a:null),u(!1)});return()=>t.unsubscribe()},[]);let p=async()=>{try{let e=l();await e.auth.signOut();let{clearTokenCache:t}=await a.e(5656).then(a.bind(a,25656));t()}catch(e){}};return(0,r.jsx)(o.Provider,{value:{user:i,session:d,loading:m,signOut:p},children:t})}function c(){let e=(0,s.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},31120:(e,t,a)=>{"use strict";a.d(t,{T:()=>n});var r=a(95155),s=a(12115),i=a(64269);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...s})});n.displayName="Textarea"},46767:(e,t,a)=>{"use strict";a.d(t,{Bc:()=>l,ZI:()=>c,k$:()=>d,m_:()=>o});var r=a(95155),s=a(12115),i=a(47520),n=a(64269);let l=i.Kq,o=i.bL,d=s.forwardRef((e,t)=>(0,r.jsx)(i.l9,{ref:t,...e}));d.displayName=i.l9.displayName;let c=s.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...l}=e;return(0,r.jsx)(i.UC,{ref:t,sideOffset:s,className:(0,n.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})});c.displayName=i.UC.displayName},51834:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>p,Es:()=>h,L3:()=>g,c7:()=>x,lG:()=>o,rr:()=>b,zM:()=>d});var r=a(95155),s=a(12115),i=a(89511),n=a(65229),l=a(64269);let o=i.bL,d=s.forwardRef((e,t)=>(0,r.jsx)(i.l9,{ref:t,...e}));d.displayName=i.l9.displayName;let c=i.ZL,m=s.forwardRef((e,t)=>(0,r.jsx)(i.bm,{ref:t,...e}));m.displayName=i.bm.displayName;let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.hJ,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});u.displayName=i.hJ.displayName;let p=s.forwardRef((e,t)=>{let{className:a,children:s,...o}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(u,{}),(0,r.jsxs)(i.UC,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[s,(0,r.jsxs)(m,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(n.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});p.displayName=i.UC.displayName;let x=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};x.displayName="DialogHeader";let h=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};h.displayName="DialogFooter";let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.hE,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",a),...s})});g.displayName=i.hE.displayName;let b=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.VY,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...s})});b.displayName=i.VY.displayName},62890:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(96648);function s(){return(0,r.createBrowserSupabase)()}},66249:(e,t,a)=>{Promise.resolve().then(a.bind(a,77384))},74832:(e,t,a)=>{"use strict";function r(e){if(!e)return"/app/dashboard";try{let t=window.location.origin,a=new URL(e,t);if(a.origin!==t)return"/app/dashboard";let r=a.pathname+(a.search||"");return r.startsWith("/")?r:"/app/dashboard"}catch(e){return"/app/dashboard"}}function s(e){let t=encodeURIComponent(e||"/app/dashboard");return"/signin?next=".concat(t)}a.d(t,{n:()=>r,q:()=>s})},76444:(e,t,a)=>{"use strict";a.d(t,{J:()=>d});var r=a(95155),s=a(12115),i=a(10489),n=a(83101),l=a(64269);let o=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.b,{ref:t,className:(0,l.cn)(o(),a),...s})});d.displayName=i.b.displayName},77384:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ee,dynamic:()=>X});var r=a(95155),s=a(12115),i=a(20063),n=a(22544),l=a(66942),o=a(22454),d=a(1733),c=a(26497),m=a(3998),u=a(86948),p=a(65142),x=a(31120),h=a(76444),g=a(11186),b=a(54879);let f=b.Ik({name:b.Yj().trim().optional(),mrn:b.Yj().trim().optional(),age:b.vk(e=>""===e||void 0===e?void 0:Number(e),b.ai({required_error:"Patient age is required",invalid_type_error:"Please enter a valid age"}).int("Age must be a whole number").positive("Age must be greater than 0").max(130,"Please enter a valid age (maximum 130)")),sex:b.k5(["M","F","O"],{required_error:"Please select the patient's sex",invalid_type_error:"Please select a valid option"})}),j=b.Ik({name:b.Yj().optional(),date:b.Yj().optional()}),v=b.Ik({templateId:b.Yj().min(1,"Template is required"),includePatient:b.zM().default(!0),patient:f,indication:b.Yj().trim().min(1,"Indication/history is required"),findings:b.Yj().trim().min(1,"Findings are required"),technique:b.Yj().trim().optional(),signature:j.default({name:"",date:""})});var y=a(25656),N=a(51056),w=a(74832),_=a(18720),k=a(35299),F=a(6132),C=a(89715),S=a(20508),E=a(7744),R=a(57828),A=a(35626),D=a(48314),I=a(42529),T=a(90368),P=a(27937),M=a(8971),q=a(18927),L=a(91162),O=a(62785),U=a(46767),z=a(80021),B=a(71708),Y=a(18098),J=a(39142);class W{connect(){var e;if((null==(e=this.ws)?void 0:e.readyState)!==WebSocket.OPEN){this.isClosedManually=!1;try{let e,t=(this.config.url||"https://api.radly.app").trim(),a=t.match(/^https?:|^wss?:/)?t:"https://".concat(t);try{e=new URL(a)}catch(t){e=new URL("https://api.radly.app")}"edge.radly.app"===e.hostname&&(e.hostname="api.radly.app"),e.protocol="http:"===e.protocol?"ws:":"wss:";let r=e.pathname.replace(/\/+$/,""),s="".concat(e.origin).concat(r),i="".concat(s,"/v1/transcribe/stream?token=").concat(encodeURIComponent(this.config.token));this.ws=new WebSocket(i),this.ws.onopen=()=>{this.reconnectAttempts=0,this.config.onOpen()},this.ws.onmessage=e=>{try{let t=JSON.parse(e.data);this.config.onMessage(t)}catch(e){this.config.onError(Error("Failed to parse WebSocket message"))}},this.ws.onerror=e=>{setTimeout(()=>{var e;(null==(e=this.ws)?void 0:e.readyState)===WebSocket.CLOSED&&this.config.onError(Error("WebSocket connection error"))},100)},this.ws.onclose=e=>{if(e.code,this.config.onClose(e.code,e.reason),1008===e.code){this.isClosedManually=!0;return}if(!this.isClosedManually&&this.config.reconnect&&this.reconnectAttempts<(this.config.maxReconnectAttempts||3)){this.reconnectAttempts++;let e=this.config.reconnectDelay*Math.pow(2,this.reconnectAttempts-1);this.reconnectTimer=setTimeout(()=>{this.connect()},e)}}}catch(e){this.config.onError(e instanceof Error?e:Error("Failed to create WebSocket connection"))}}}send(e){if(!this.ws||this.ws.readyState!==WebSocket.OPEN)return!1;try{return this.ws.send(e),!0}catch(e){return this.config.onError(e instanceof Error?e:Error("Failed to send data")),!1}}close(){if(this.isClosedManually=!0,this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.ws){if(this.ws.readyState===WebSocket.OPEN)try{this.ws.send("close")}catch(e){}this.ws.close(),this.ws=null}this.reconnectAttempts=0}get isOpen(){var e;return(null==(e=this.ws)?void 0:e.readyState)===WebSocket.OPEN}get isConnecting(){var e;return(null==(e=this.ws)?void 0:e.readyState)===WebSocket.CONNECTING}get isClosed(){var e;return(null==(e=this.ws)?void 0:e.readyState)===WebSocket.CLOSED}constructor(e){this.ws=null,this.reconnectAttempts=0,this.reconnectTimer=null,this.isClosedManually=!1,this.config={reconnect:!0,maxReconnectAttempts:3,reconnectDelay:2e3,...e}}}var V=a(64269);function $(e){let{onTranscript:t,onError:a,onUpgradeRequired:i,disabled:n=!1,className:l}=e,{state:o,interimTranscript:d,error:c,isRecording:u,duration:p,maxDuration:x,timeRemaining:h,tier:g,startRecording:b,stopRecording:f,clearError:j}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{session:t}=(0,q.A)(),[a,r]=(0,s.useState)("idle"),[i,n]=(0,s.useState)(""),[l,o]=(0,s.useState)(""),[d,c]=(0,s.useState)(null),[m,u]=(0,s.useState)(0),[p,x]=(0,s.useState)(0),[h,g]=(0,s.useState)(null),b=(0,s.useRef)(null),f=(0,s.useRef)(null),j=(0,s.useRef)(null),v=(0,s.useRef)(null),y=(0,s.useRef)(null),N=e.apiBase||"https://edge.radly.app";(0,s.useEffect)(()=>()=>{R()},[]);let w=(0,s.useCallback)(()=>{u(0),v.current=setInterval(()=>{u(e=>e+1)},1e3)},[]),_=(0,s.useCallback)(()=>{v.current&&(clearInterval(v.current),v.current=null)},[]),k=(0,s.useCallback)(()=>{y.current=setInterval(()=>{var e;(null==(e=f.current)?void 0:e.state)==="recording"&&f.current.requestData()},1e3)},[]),F=(0,s.useCallback)(()=>{y.current&&(clearInterval(y.current),y.current=null)},[]),C=(0,s.useCallback)(t=>{c("string"==typeof t?t:t.message),r("error"),F(),e.onError&&e.onError("string"==typeof t?Error(t):t),R()},[e,F]),S=(0,s.useCallback)(t=>{switch(t.type){case"connection_established":g(t.tier),x(t.max_duration_seconds),r("recording"),w();break;case"transcript":t.is_final?(n(a=>{let r=a+(a?" ":"")+t.transcript;return e.onTranscript&&e.onTranscript(t.transcript,!0),r}),o("")):(o(t.transcript),e.onTranscript&&e.onTranscript(t.transcript,!1));break;case"duration_limit_reached":e.onLimitReached&&e.onLimitReached(t.message),C(t.message);break;case"error":C(t.message)}},[e,w,C]),E=(0,s.useCallback)(async()=>{try{var e,s,i,l;if(!(null==t?void 0:t.access_token))throw Error("Authentication required");if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw Error("Browser does not support audio recording");if(!window.MediaRecorder)throw Error("Browser does not support MediaRecorder");c(null),n(""),o(""),u(0),r("connecting");let d=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:16e3,echoCancellation:!0,noiseSuppression:!0}});j.current=d;let m=d.getAudioTracks();if(0===m.length)throw Error("No audio tracks found in media stream");if(!(null==(e=m[0])?void 0:e.enabled)||(null==(s=m[0])?void 0:s.readyState)!=="live")throw Error("Audio track is not enabled or not live");let p="audio/webm";MediaRecorder.isTypeSupported("audio/webm;codecs=opus")?p="audio/webm;codecs=opus":MediaRecorder.isTypeSupported("audio/webm")?p="audio/webm":MediaRecorder.isTypeSupported("audio/ogg;codecs=opus")&&(p="audio/ogg;codecs=opus");let x=new MediaRecorder(d,{mimeType:p});f.current=x,x.ondataavailable=e=>{var t;let a=e.data.size;e.data.type,0===a&&j.current&&j.current.getAudioTracks();let r=b.current;null==(t=f.current)||t.state,r&&r.isOpen&&r.isOpen&&a>0&&r.send(e.data)},x.onerror=e=>{C("Recording error occurred")};let h=(i=t.access_token,l={onOpen:()=>{},onMessage:e=>{if(S(e),"connection_established"===e.type){var t;(null==(t=f.current)?void 0:t.state)==="inactive"&&(f.current.start(250),k())}},onError:e=>{C(e)},onClose:(e,t)=>{1008===e?C(t||"Access denied. Please check your subscription plan."):1e3!==e&&"recording"===a&&C("Connection lost")},reconnect:!1},new W({url:N,token:i,...l}));b.current=h,h.connect()}catch(e){e instanceof Error?"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?C("Microphone permission denied. Please allow microphone access."):"NotFoundError"===e.name?C("No microphone found. Please connect a microphone."):C(e):C("Failed to start recording")}},[t,N,a,S,C,k]),R=(0,s.useCallback)(()=>{_(),F(),f.current&&"inactive"!==f.current.state&&f.current.stop(),j.current&&(j.current.getTracks().forEach(e=>e.stop()),j.current=null),b.current&&(b.current.close(),b.current=null),"error"!==a&&r("idle"),f.current=null},[a,_,F]),A=(0,s.useCallback)(()=>{n(""),o("")},[]),D=(0,s.useCallback)(()=>{c(null),"error"===a&&r("idle")},[a]);return{state:a,transcript:i,interimTranscript:l,error:d,isRecording:"recording"===a,duration:m,maxDuration:p,timeRemaining:p-m,tier:h,startRecording:E,stopRecording:R,clearTranscript:A,clearError:D}}({onTranscript:(e,a)=>{if(a){let a=()=>t(e);"function"==typeof queueMicrotask?queueMicrotask(a):Promise.resolve().then(a)}},onError:e=>{a&&a(e.message)},onLimitReached:e=>{a&&a(e)}});(0,s.useEffect)(()=>{c&&(a&&a(c),(c.includes("Starter tier")||c.includes("trial")||c.includes("upgrade"))&&i&&g&&i(g))},[c,g,a,i]);let v=e=>{let t=Math.floor(e/60);return"".concat(t,":").concat((e%60).toString().padStart(2,"0"))},y=u&&h<=30&&h>0,N=u&&h<=10&&h>0;return(0,r.jsxs)("div",{className:(0,V.cn)("flex flex-col gap-2",l),children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(m.$,{type:"button",variant:c?"destructive":u?"default":"outline",size:"sm",onClick:()=>{if(c)return void j();u?f():b()},disabled:n||"connecting"===o||"processing"===o,title:c?"Click to retry":u?"Stop recording":"connecting"===o?"Connecting...":"Start voice dictation",className:(0,V.cn)("relative",u&&"animate-pulse",c&&"border-destructive"),children:["connecting"===o||"processing"===o?(0,r.jsx)(k.A,{className:"h-4 w-4 animate-spin"}):c?(0,r.jsx)(Y.A,{className:"h-4 w-4"}):(0,r.jsx)(J.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"ml-2",children:c?"Retry":u?"Stop":"Voice Dictation"}),u&&(0,r.jsxs)("span",{className:"absolute -top-1 -right-1 flex h-3 w-3",children:[(0,r.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),(0,r.jsx)("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-red-500"})]})]}),u&&(0,r.jsxs)("div",{className:(0,V.cn)("flex items-center gap-2 text-sm font-mono",N&&"text-destructive font-bold",y&&!N&&"text-yellow-600 dark:text-yellow-500"),children:[(0,r.jsx)("span",{children:v(p)}),(0,r.jsx)("span",{className:"text-muted-foreground",children:"/"}),(0,r.jsx)("span",{className:(0,V.cn)(N&&"animate-pulse"),children:v(x)})]})]}),(u||"connecting"===o)&&(0,r.jsx)("div",{className:"flex items-start gap-2 text-sm min-h-[2rem]",children:"connecting"===o?(0,r.jsx)("div",{className:"text-muted-foreground italic",children:"Connecting to transcription service..."}):d?(0,r.jsx)("div",{className:"text-muted-foreground italic border-l-2 border-primary pl-2",children:d}):(0,r.jsx)("div",{className:"text-muted-foreground italic",children:"Listening..."})}),c&&(0,r.jsx)("div",{className:"text-sm text-destructive bg-destructive/10 border border-destructive/20 rounded-md p-2",children:c}),!u&&!c&&(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Tip: Press"," ",(0,r.jsx)("kbd",{className:"px-1 py-0.5 text-xs font-semibold border border-border rounded",children:"Ctrl+Shift+V"})," ","to start/stop"]})]})}var G=a(56154),Z=a(26983),K=a(51834);let H={free:{maxDuration:60,dailyLimit:0,maxConcurrentStreams:3,hasAccess:!0,isTrial:!0,trialLimit:3},starter:{maxDuration:0,dailyLimit:0,maxConcurrentStreams:0,hasAccess:!1},professional:{maxDuration:180,dailyLimit:100,maxConcurrentStreams:10,hasAccess:!0},premium:{maxDuration:300,dailyLimit:300,maxConcurrentStreams:15,hasAccess:!0}};function Q(e){let{open:t,onClose:a,currentTier:s,reason:i,onUpgrade:n}=e,{title:l,description:o,icon:d}=(()=>{switch(i){case"trial_exhausted":return{title:"Free Trial Completed",description:"You've used your 3 free voice dictation trials. Upgrade to Professional or Premium to continue using this powerful feature.",icon:(0,r.jsx)(J.A,{className:"h-12 w-12 text-primary"})};case"tier_blocked":return{title:"Premium Feature",description:"Voice dictation is available for Professional and Premium plans. Upgrade to unlock this feature and speed up your report generation.",icon:(0,r.jsx)(G.A,{className:"h-12 w-12 text-yellow-500"})};case"daily_limit":return{title:"Daily Limit Reached",description:"You've reached your daily transcription limit. Upgrade to Premium for higher limits and longer recording times.",icon:(0,r.jsx)(Z.A,{className:"h-12 w-12 text-orange-500"})}}})(),c="free"===s||"starter"===s?"professional":"premium",u=H[c],p=["".concat(u.dailyLimit," transcriptions per day"),"Up to ".concat(Math.floor(u.maxDuration/60)," minutes per recording"),"".concat(u.maxConcurrentStreams," concurrent streams"),"Medical terminology optimized","Real-time transcription","No trial limits"];return(0,r.jsx)(K.lG,{open:t,onOpenChange:a,children:(0,r.jsxs)(K.Cf,{className:"sm:max-w-[500px]",children:[(0,r.jsxs)(K.c7,{children:[(0,r.jsx)("div",{className:"flex justify-center mb-4",children:d}),(0,r.jsx)(K.L3,{className:"text-center text-2xl",children:l}),(0,r.jsx)(K.rr,{className:"text-center text-base pt-2",children:o})]}),(0,r.jsx)("div",{className:"py-4",children:(0,r.jsxs)("div",{className:"bg-primary/5 border border-primary/20 rounded-lg p-4",children:[(0,r.jsxs)("h4",{className:"font-semibold text-lg mb-3 capitalize flex items-center gap-2",children:[(0,r.jsx)(G.A,{className:"h-5 w-5 text-primary"}),c," Plan"]}),(0,r.jsx)("ul",{className:"space-y-2",children:p.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-start gap-2 text-sm",children:[(0,r.jsx)(I.A,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),(0,r.jsx)("span",{children:e})]},t))})]})}),"professional"===s&&"premium"===c&&(0,r.jsxs)("div",{className:"text-sm text-muted-foreground text-center pb-2",children:["Your current Professional plan gives you ",H.professional.dailyLimit," ","transcriptions per day. Upgrade to Premium for"," ",H.premium.dailyLimit," per day."]}),(0,r.jsxs)(K.Es,{className:"flex gap-2 sm:gap-2",children:[(0,r.jsx)(m.$,{variant:"outline",onClick:a,className:"flex-1",children:"Maybe Later"}),(0,r.jsxs)(m.$,{onClick:n,className:"flex-1",children:["Upgrade to ",c]})]})]})})}let X="force-dynamic";function ee(){var e,t,a,b;let f=(0,i.useRouter)(),j=(0,i.useSearchParams)(),{userId:Y}=(0,M.L)(),{user:J}=(0,q.A)(),W=function(e){let t=t=>{if(e instanceof URLSearchParams)return e.get(t)||void 0;let a=e[t];return Array.isArray(a)?a[0]:a};for(let e of["template","templateId","template_id","templated","templte","tid"]){let a=t(e);if(a)return String(a)}}(j),[G,Z]=(0,s.useState)(1),[K,H]=(0,s.useState)(!1),[X,ee]=(0,s.useState)(null),[et,ea]=(0,s.useState)(!1),[er,es]=(0,s.useState)(!1),[ei,en]=(0,s.useState)("tier_blocked"),[el,eo]=(0,s.useState)("free"),{data:ed,isLoading:ec,error:em}=(0,o.I)({queryKey:["template",W],queryFn:async()=>{if(!W)return null;try{let e=await (0,y.lx)("/v1/template/".concat(W)),t=e&&(e.title||e.name||e.display_name||e.label)||"(Untitled Template)";return{...e,templateTitle:t}}catch(e){if(e instanceof Error&&e.message.includes("401")){let e=window.location.pathname+window.location.search;return window.location.href=(0,w.q)(e),null}throw e}},enabled:!!W}),{data:eu}=(0,o.I)({queryKey:["profile",null==J?void 0:J.id],queryFn:async()=>J?{...await (0,L.Sk)(J.id),email:J.email||""}:null,enabled:!!J,...L.eU}),{data:ep}=(0,o.I)({queryKey:["subscription-usage"],queryFn:()=>(0,y.lx)("/v1/subscription/usage"),enabled:!!J}),{register:ex,handleSubmit:eh,watch:eg,setValue:eb,reset:ef,trigger:ej,formState:{errors:ev,isDirty:ey,isSubmitting:eN}}=(0,n.mN)({resolver:(0,l.u)(v),mode:"onBlur",reValidateMode:"onChange",defaultValues:{templateId:W||"",includePatient:!0,patient:{name:"",mrn:"",age:void 0,sex:void 0},indication:"",findings:"",technique:"",signature:{name:"",date:new Date().toLocaleDateString()}}}),{restoreDraft:ew,clearDraft:e_}=function(e){let{key:t,watch:a,setValue:r,enabled:i=!0}=e,n="form-draft-".concat(t);(0,s.useEffect)(()=>{if(!i)return;let e=a(e=>{try{Object.values(e).some(e=>"string"==typeof e?e.trim().length>0:"object"==typeof e&&null!==e?Object.values(e).some(e=>"string"==typeof e?e.trim().length>0:!!e):!!e)&&localStorage.setItem(n,JSON.stringify({data:e,timestamp:Date.now()}))}catch(e){}});return()=>e.unsubscribe()},[a,n,i]);let l=(0,s.useCallback)(()=>{if(!i)return null;try{let e=localStorage.getItem(n);if(!e)return null;let{data:t,timestamp:a}=JSON.parse(e);if(Date.now()-a>864e5)return localStorage.removeItem(n),null;return{data:t,timestamp:a,age:Date.now()-a}}catch(e){return null}},[n,i]);return{restoreDraft:l,applyDraft:(0,s.useCallback)(e=>{e&&Object.entries(e).forEach(e=>{let[t,a]=e;r(t,a,{shouldValidate:!1})})},[r]),clearDraft:(0,s.useCallback)(()=>{try{localStorage.removeItem(n)}catch(e){}},[n])}}({key:"generate-".concat(W||"default"),watch:eg,setValue:eb,enabled:!0}),[ek,eF]=(0,s.useState)(!1),[eC,eS]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=ew();e&&e.data&&(eS(e.data),eF(!0))},[ew]),(0,s.useEffect)(()=>{if(eu){let e=eu.default_signature_date_format?new Date().toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,eu.default_signature_date_format.includes("/")?"/":"-"):new Date().toLocaleDateString();ef({templateId:W||"",includePatient:!0,patient:{name:"",mrn:"",age:void 0,sex:void 0},indication:"",findings:"",technique:"",signature:{name:eu.default_signature_name||"",date:e}})}},[eu,ef,W]),(0,s.useEffect)(()=>{ea(!1)},[G]),(0,s.useEffect)(()=>{let e=e=>{if(ey&&!eN)return e.preventDefault(),e.returnValue="",""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[ey,eN]);let eE=(0,s.useCallback)(async()=>{if(1===G)return void Z(2);if(2===G)return await ej(["patient.age","patient.sex"],{shouldFocus:!0})?void Z(3):void _.oR.error("Please complete the required patient details before continuing.");if(3===G){if(!await ej(["indication","findings"],{shouldFocus:!0}))return void _.oR.error("Clinical information is required to continue.");Z(4)}},[G,ej]),eR=(0,s.useCallback)(()=>{Z(e=>Math.max(1,e-1))},[]),eA=(0,s.useCallback)(e=>{let t=(eg("findings")||"").trimEnd();eb("findings","".concat(t).concat(t?"\n\n":"").concat(e),{shouldValidate:!0,shouldDirty:!0})},[eg,eb]),eD=(0,s.useCallback)(e=>{_.oR.error(e),(e.includes("trial")||e.includes("upgrade")||e.includes("Starter"))&&(e.includes("trial")?en("trial_exhausted"):e.includes("daily limit")?en("daily_limit"):en("tier_blocked"),es(!0))},[]),eI=(0,s.useCallback)(e=>{eo(e),en("tier_blocked"),es(!0)},[]);(0,s.useEffect)(()=>{W||f.replace("/app/templates")},[W,f]),(0,s.useEffect)(()=>{W&&localStorage.setItem("recent-template-id",W)},[W]),(0,s.useEffect)(()=>{let e=ed&&"object"==typeof ed&&null!==ed&&"templateTitle"in ed&&"string"==typeof ed.templateTitle?ed.templateTitle:null;W&&e&&localStorage.setItem("recent-template-name",e)},[W,ed]);let eT=ed&&"object"==typeof ed?ed:{};if(!W)return(0,r.jsx)("div",{className:"flex min-h-[60vh] items-center justify-center p-6",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-3 text-center text-muted-foreground",children:[(0,r.jsx)(k.A,{className:"h-6 w-6 animate-spin"}),(0,r.jsx)("p",{children:"Redirecting you to Templates…"})]})});if(ec)return(0,r.jsx)("div",{className:"flex min-h-[60vh] items-center justify-center p-6",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-3 text-center text-muted-foreground",children:[(0,r.jsx)(k.A,{className:"h-6 w-6 animate-spin"}),(0,r.jsx)("p",{children:"Loading template details…"})]})});if(em)return(0,r.jsx)("div",{className:"flex min-h-[60vh] items-center justify-center p-6",children:(0,r.jsxs)("div",{className:"aurora-card w-full max-w-md border border-[rgba(255,107,107,0.35)] bg-[rgba(255,107,107,0.12)] p-6 text-center",children:[(0,r.jsx)(F.A,{className:"mx-auto mb-3 h-8 w-8 text-[#FFD1D1]"}),(0,r.jsx)("h2",{className:"mb-2 text-lg font-semibold text-white",children:"Unable to load template"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(255,209,209,0.8)]",children:"We couldn't load the selected template. It may have been removed or you may no longer have access."}),(0,r.jsxs)("div",{className:"mt-4 flex justify-center gap-3",children:[(0,r.jsx)(m.$,{variant:"ghost",onClick:()=>f.push("/app/templates"),className:"rounded-xl border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.75)] px-5 text-[rgba(207,207,207,0.85)] hover:border-[rgba(75,142,255,0.45)] hover:bg-[rgba(75,142,255,0.18)] hover:text-white",children:"Browse templates"}),(0,r.jsx)(m.$,{variant:"ghost",onClick:()=>window.location.reload(),className:"rounded-xl border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.75)] px-5 text-[rgba(207,207,207,0.85)] hover:border-[rgba(75,142,255,0.45)] hover:bg-[rgba(75,142,255,0.18)] hover:text-white",children:"Retry"})]})]})});let eP=async e=>{if(4===G&&et){if((null==ep?void 0:ep.subscription)&&ep.subscription.reports_used>=ep.subscription.reports_limit){ee("You have reached your monthly report limit. Please upgrade your plan or wait for the next billing cycle."),_.oR.error("Usage limit reached. Please upgrade to continue generating reports.");return}H(!0),ee(null);try{var t;let r={name:e.patient.name||void 0,mrn:e.patient.mrn||void 0,age:null!=(t=e.patient.age)?t:void 0,sex:e.patient.sex||void 0},s={templateId:W||e.templateId,indication:e.indication,findings:e.findings,impression:e.indication,technique:e.technique,patient:r,signature:e.signature},i=(await (0,N.Ix)(s)).job_id;e_();let n={origin:{y:.7},zIndex:9999};function a(e,t){(0,B.A)({...n,...t,particleCount:Math.floor(200*e)})}a(.25,{spread:26,startVelocity:55}),a(.2,{spread:60}),a(.35,{spread:100,decay:.91,scalar:.8}),a(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2}),a(.1,{spread:120,startVelocity:45});try{if(Y){let e="radly_recent_jobs_local_".concat(Y),t=JSON.parse(localStorage.getItem(e)||"[]");t.unshift({job_id:i,status:"queued",template_id:s.templateId,title:"Generating…",created_at:Date.now()}),localStorage.setItem(e,JSON.stringify(t))}}catch(e){}sessionStorage.setItem("radly:lastJobId",i),_.oR.success("Report generation started!"),f.push("/app/report?id=".concat(i))}catch(t){let e="Failed to start report generation";if(t&&"object"==typeof t&&"status"in t){let a=t.status;if(401===a){_.oR.error("Session expired. Please sign in again.");let e=window.location.pathname+window.location.search;window.location.href=(0,w.q)(e);return}403===a?e="You don't have permission to generate reports. Please check your subscription.":429===a?e="Too many requests. Please wait a moment and try again.":404===a?e="Template not found. Please select a different template.":a>=500&&(e="Server error. Please try again in a few moments.")}t instanceof Error&&(t.message.includes("quota")||t.message.includes("limit"))&&(e="Monthly report limit reached. Please upgrade your plan to continue."),t instanceof Error&&(t.message.includes("fetch")||t.message.includes("network"))&&(e="Network error. Please check your connection and try again."),t instanceof Error&&t.message&&t.message.length>10&&(e=t.message),ee(e),_.oR.error(e)}finally{H(!1)}}},eM=[{id:1,name:"Template",icon:C.A},{id:2,name:"Patient Info",icon:S.A},{id:3,name:"Clinical Data",icon:E.A},{id:4,name:"Review",icon:R.A}];return(0,r.jsx)("div",{className:"min-h-screen bg-[var(--ds-bg-gradient)] text-white",children:(0,r.jsxs)("main",{className:"mx-auto max-w-5xl space-y-6 sm:space-y-8 px-4 sm:px-6 py-10 sm:py-12 pb-28",children:[(0,r.jsx)(O.Q,{items:[{label:"Templates",href:"/app/templates"},{label:"Generate Report"}]}),(0,r.jsxs)("div",{className:"neon-shell space-y-6 p-6 sm:p-8 md:p-10 backdrop-blur-xl",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(m.$,{variant:"ghost",onClick:()=>f.push("/app/templates"),className:"gap-2 text-[rgba(207,207,207,0.78)] hover:text-white","aria-label":"Go back to templates",children:[(0,r.jsx)(A.A,{className:"w-4 h-4"}),"Back"]}),(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl font-semibold text-white",children:"Generate Report"}),(0,r.jsx)("div",{className:"w-24"})]}),(0,r.jsx)(u.Zp,{className:"aurora-card border border-[rgba(255,255,255,0.08)] text-white",children:(0,r.jsxs)(u.Wu,{className:"p-4 sm:p-6",children:[(0,r.jsx)("div",{className:"flex sm:hidden justify-center gap-2 mb-4",children:eM.map(e=>(0,r.jsx)(d.P.div,{className:"h-2 rounded-full transition-all ".concat(G>=e.id?"bg-[linear-gradient(90deg,#2653FF_0%,#4B8EFF_50%,#8F82FF_100%)] w-8":"bg-[rgba(207,207,207,0.25)] w-6"),layout:!0},e.id))}),(0,r.jsxs)("div",{className:"hidden sm:flex items-center justify-between relative",children:[(0,r.jsx)("div",{className:"absolute top-6 left-0 right-0 h-0.5 bg-[rgba(207,207,207,0.18)]",children:(0,r.jsx)(d.P.div,{className:"h-full bg-[linear-gradient(90deg,#2653FF_0%,#4B8EFF_60%,#8F82FF_100%)]",animate:{width:"".concat((G-1)/(eM.length-1)*100,"%")},transition:{duration:.3}})}),(0,r.jsx)("div",{className:"relative z-10 flex w-full items-center justify-between",children:eM.map(e=>{let t=G===e.id,a=G>e.id;return(0,r.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,r.jsx)("div",{className:(0,V.cn)("flex h-14 w-14 items-center justify-center rounded-full border transition-all",t||a?"border-[rgba(75,142,255,0.45)] bg-[linear-gradient(135deg,#2653FF,#8F82FF)] text-white shadow-[0_18px_42px_rgba(31,64,175,0.4)]":"border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.85)] text-[rgba(207,207,207,0.5)]"),children:(0,r.jsx)(e.icon,{className:"h-6 w-6"})}),(0,r.jsx)("span",{className:(0,V.cn)("text-xs uppercase tracking-[0.18em] text-[rgba(207,207,207,0.5)]",t&&"text-white"),children:e.name})]},e.id)})})]})]})})]}),ek&&eC&&(0,r.jsx)("div",{className:"aurora-card border border-[rgba(75,142,255,0.35)] bg-[rgba(75,142,255,0.12)] p-4 sm:p-5 rounded-2xl",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[(0,r.jsx)(D.A,{className:"h-5 w-5 text-[#4B8EFF] flex-shrink-0 mt-0.5"}),(0,r.jsx)("p",{className:"text-sm sm:text-base text-white break-words",children:"We found a saved draft from your previous session. Would you like to restore it?"})]}),(0,r.jsxs)("div",{className:"flex gap-2 sm:gap-3 sm:flex-shrink-0",children:[(0,r.jsx)(m.$,{size:"sm",variant:"ghost",onClick:()=>{eF(!1),eS(null),e_()},className:"flex-1 sm:flex-none min-h-[44px] rounded-lg border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.78)] text-[rgba(207,207,207,0.85)] hover:border-[rgba(255,255,255,0.3)] hover:text-white",children:"Discard"}),(0,r.jsx)(m.$,{size:"sm",onClick:()=>{Object.entries(eC).forEach(e=>{let[t,a]=e;eb(t,a,{shouldValidate:!1})}),eF(!1),_.oR.success("Draft restored successfully")},className:"flex-1 sm:flex-none min-h-[44px] rounded-lg bg-[linear-gradient(90deg,#2653FF_0%,#4B8EFF_100%)] text-white shadow-[0_12px_28px_rgba(75,142,255,0.32)]",children:"Restore"})]})]})}),X&&(0,r.jsx)("div",{className:"rounded-2xl border border-[rgba(255,107,107,0.35)] bg-[rgba(255,107,107,0.12)] p-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(F.A,{className:"h-5 w-5 text-[#FFD1D1]"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-white",children:"Error"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(255,209,209,0.85)]",children:X})]})]})}),(null==ep?void 0:ep.subscription)&&ep.subscription.reports_used>=ep.subscription.reports_limit&&(0,r.jsx)(u.Zp,{className:"aurora-card border border-[rgba(255,107,107,0.35)] bg-[rgba(255,107,107,0.12)]",children:(0,r.jsx)(u.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(F.A,{className:"h-5 w-5 text-[#FFD1D1] flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"mb-1 text-base font-semibold text-white",children:"Monthly Limit Reached"}),(0,r.jsxs)("p",{className:"mb-3 text-sm text-[rgba(255,209,209,0.8)]",children:["You have used ",ep.subscription.reports_used," of ",ep.subscription.reports_limit," reports this month. Upgrade your plan to continue generating reports immediately."]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(m.$,{size:"sm",onClick:()=>f.push("/pricing"),className:"rounded-lg bg-[linear-gradient(90deg,#FF6B6B_0%,#FF9F6B_100%)] px-4 text-white shadow-[0_12px_28px_rgba(255,107,107,0.32)]",children:"Upgrade Plan"}),(0,r.jsx)(m.$,{size:"sm",variant:"ghost",onClick:()=>f.push("/app/dashboard"),className:"rounded-lg border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.78)] px-4 text-[rgba(207,207,207,0.85)] hover:border-[rgba(255,255,255,0.3)] hover:text-white",children:"Back to Dashboard"})]})]})]})})}),(0,r.jsxs)("form",{onSubmit:eh(eP),className:"space-y-6",onKeyDown:e=>{if("Enter"!==e.key)return;let t=e.target;!(t instanceof HTMLTextAreaElement||t instanceof HTMLButtonElement)&&(e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||t instanceof HTMLInputElement&&"submit"!==t.type&&e.preventDefault())},children:[(0,r.jsx)(c.N,{mode:"wait",children:(0,r.jsxs)(d.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[1===G&&(0,r.jsxs)("div",{className:"aurora-card border border-[rgba(255,255,255,0.08)] overflow-hidden",children:[(0,r.jsx)("div",{className:"border-b border-[rgba(255,255,255,0.08)] bg-[rgba(12,16,28,0.78)] px-4 sm:px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-[linear-gradient(135deg,#2653FF,#8F82FF)] shadow-[0_14px_32px_rgba(31,64,175,0.35)] flex-shrink-0",children:(0,r.jsx)(C.A,{className:"h-5 w-5 text-white"})}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-white",children:"Template Selection"}),(0,r.jsx)("p",{className:"text-xs sm:text-sm text-[rgba(207,207,207,0.65)]",children:"Confirm the template you're using for this report."})]})]})}),(0,r.jsx)("div",{className:"p-4 sm:p-6 md:p-8",children:(0,r.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,r.jsxs)("div",{className:"rounded-2xl border border-[rgba(75,142,255,0.3)] bg-[rgba(12,16,28,0.65)] p-5 sm:p-6 text-center",children:[(0,r.jsx)("h3",{className:"text-xl sm:text-2xl font-semibold text-white mb-4",children:eT.templateTitle||"(Untitled Template)"}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-2 text-xs sm:text-sm text-[#D7E3FF] mb-6",children:[eT.modality&&(0,r.jsx)("span",{className:"rounded-full bg-[rgba(75,142,255,0.18)] px-3 py-1.5 font-semibold",children:eT.modality}),eT.body_system&&(0,r.jsx)("span",{className:"rounded-full bg-[rgba(75,142,255,0.18)] px-3 py-1.5 font-semibold",children:eT.body_system}),eT.anatomy&&(0,r.jsx)("span",{className:"rounded-full bg-[rgba(75,142,255,0.18)] px-3 py-1.5 font-semibold",children:eT.anatomy})]}),(0,r.jsx)(m.$,{variant:"ghost",size:"sm",className:"rounded-lg border border-[rgba(255,255,255,0.12)] bg-[rgba(18,22,36,0.72)] px-5 py-2 text-[rgba(207,207,207,0.8)] hover:border-[rgba(75,142,255,0.45)] hover:bg-[rgba(75,142,255,0.18)] hover:text-white min-h-[44px]",onClick:()=>f.push("/app/templates"),children:"Change template"})]})})})]}),2===G&&(0,r.jsxs)("div",{className:"aurora-card border border-[rgba(255,255,255,0.08)] overflow-hidden",children:[(0,r.jsx)("div",{className:"border-b border-[rgba(255,255,255,0.08)] bg-[rgba(12,16,28,0.78)] px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-[linear-gradient(135deg,#3FBF8C,#6EE7B7)] text-white shadow-[0_14px_32px_rgba(63,191,140,0.35)]",children:(0,r.jsx)(S.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Patient Information"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(207,207,207,0.65)]",children:"Provide patient details (age and sex are required)."})]})]})}),(0,r.jsx)("div",{className:"space-y-4 p-5 sm:p-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"patient.name",className:"text-[rgba(207,207,207,0.75)]",children:"Patient Name (optional)"}),(0,r.jsx)(p.p,{id:"patient.name",inputMode:"text",autoCapitalize:"words",autoComplete:"name",...ex("patient.name"),placeholder:"John Doe",className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)] input-mobile"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"patient.mrn",className:"text-[rgba(207,207,207,0.75)]",children:"Medical Record Number (optional)"}),(0,r.jsx)(p.p,{id:"patient.mrn",inputMode:"text",autoCapitalize:"characters",autoCorrect:"off",...ex("patient.mrn"),placeholder:"MRN123456",className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)] input-mobile"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"patient.age",className:"text-[rgba(207,207,207,0.75)]",children:"Age (required)"}),(0,r.jsx)(p.p,{id:"patient.age",type:"number",inputMode:"numeric",pattern:"[0-9]*",...ex("patient.age",{valueAsNumber:!0}),placeholder:"45",className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)] input-mobile"}),(null==(e=ev.patient)?void 0:e.age)&&(0,r.jsx)("p",{className:"text-sm text-[#FF9F9F]",children:ev.patient.age.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"patient.sex",className:"text-[rgba(207,207,207,0.75)]",children:"Sex (required)"}),(0,r.jsxs)(g.l6,{value:eg("patient.sex")||"",onValueChange:e=>eb("patient.sex",e,{shouldValidate:!0}),children:[(0,r.jsx)(g.bq,{id:"patient.sex",className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white focus:border-[rgba(75,142,255,0.45)]",children:(0,r.jsx)(g.yv,{placeholder:"Select sex"})}),(0,r.jsxs)(g.gC,{className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,14,24,0.95)] text-white",children:[(0,r.jsx)(g.eb,{value:"M",children:"Male"}),(0,r.jsx)(g.eb,{value:"F",children:"Female"}),(0,r.jsx)(g.eb,{value:"O",children:"Other"})]})]}),(null==(t=ev.patient)?void 0:t.sex)&&(0,r.jsx)("p",{className:"text-sm text-[#FF9F9F]",children:ev.patient.sex.message})]})]})})]}),3===G&&(0,r.jsxs)("div",{className:"aurora-card border border-[rgba(255,255,255,0.08)] overflow-hidden",children:[(0,r.jsx)("div",{className:"border-b border-[rgba(255,255,255,0.08)] bg-[rgba(12,16,28,0.78)] px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-[linear-gradient(135deg,#4B8EFF,#8F82FF)] text-white shadow-[0_14px_32px_rgba(31,64,175,0.35)]",children:(0,r.jsx)(E.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Clinical Information"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(207,207,207,0.65)]",children:"Provide the clinical details for the report."})]})]})}),(0,r.jsx)(U.Bc,{children:(0,r.jsxs)("div",{className:"space-y-4 p-5 sm:p-6 sm:space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(h.J,{htmlFor:"indication",className:"text-[rgba(207,207,207,0.75)]",children:"Indication / Clinical history (required)"}),(0,r.jsxs)(U.m_,{children:[(0,r.jsx)(U.k$,{asChild:!0,children:(0,r.jsx)("button",{className:"inline-flex items-center justify-center",type:"button",children:(0,r.jsx)(z.A,{className:"h-4 w-4 text-muted-foreground cursor-help"})})}),(0,r.jsx)(U.ZI,{className:"max-w-xs",children:(0,r.jsx)("p",{children:"The clinical reason for ordering this study. Include relevant symptoms, prior diagnoses, or follow-up information."})})]})]}),(0,r.jsx)(x.T,{id:"indication",inputMode:"text",autoCapitalize:"sentences",...ex("indication"),placeholder:"Reason for study...",rows:3,className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)] textarea-mobile"}),ev.indication&&(0,r.jsx)("p",{className:"text-sm text-[#FF9F9F]",children:ev.indication.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(h.J,{htmlFor:"findings",className:"text-[rgba(207,207,207,0.75)]",children:"Findings (required)"}),(0,r.jsxs)(U.m_,{children:[(0,r.jsx)(U.k$,{asChild:!0,children:(0,r.jsx)("button",{className:"inline-flex items-center justify-center",type:"button",children:(0,r.jsx)(z.A,{className:"h-4 w-4 text-muted-foreground cursor-help"})})}),(0,r.jsx)(U.ZI,{className:"max-w-xs",children:(0,r.jsx)("p",{children:"Your radiological observations. Can be bulleted or free text. This will be organized into the findings section of the report."})})]})]}),ev.findings&&(0,r.jsxs)("p",{className:"text-sm text-[#FF9F9F] flex items-center gap-1.5",children:[(0,r.jsx)(F.A,{className:"h-4 w-4 flex-shrink-0"}),ev.findings.message]}),(0,r.jsx)(x.T,{id:"findings",inputMode:"text",autoCapitalize:"sentences",...ex("findings"),placeholder:"Enter your findings here. You can type bullet points, write in free text format, or use voice dictation.",rows:6,className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)] textarea-mobile"}),(0,r.jsx)("p",{className:"text-xs text-[rgba(207,207,207,0.45)]",children:"Tip: Press Enter for a new line, or use the Voice Dictation button below for hands-free input."}),(0,r.jsx)($,{onTranscript:eA,onError:eD,onUpgradeRequired:eI,disabled:K})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"technique",className:"text-[rgba(207,207,207,0.75)]",children:"Technique (optional)"}),(0,r.jsx)(p.p,{id:"technique",inputMode:"text",autoCapitalize:"sentences",...ex("technique"),placeholder:"Portal venous phase...",className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)] input-mobile"})]})]})})]}),4===G&&(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"aurora-card border border-[rgba(255,255,255,0.08)] overflow-hidden",children:[(0,r.jsx)("div",{className:"border-b border-[rgba(255,255,255,0.08)] bg-[rgba(12,16,28,0.78)] px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-[linear-gradient(135deg,#F8B74D,#FF6B6B)] text-white shadow-[0_14px_32px_rgba(255,155,80,0.35)]",children:(0,r.jsx)(I.A,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Review & Submit"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(207,207,207,0.65)]",children:"Review your information before generating the report."})]})]})}),(0,r.jsxs)("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"signature.name",className:"text-[rgba(207,207,207,0.75)]",children:"Signature Name"}),(0,r.jsx)(p.p,{id:"signature.name",...ex("signature.name"),placeholder:"Dr. Jane Smith",className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)]",onKeyDown:e=>{"Enter"===e.key&&e.preventDefault()}}),(null==(a=ev.signature)?void 0:a.name)&&(0,r.jsx)("p",{className:"text-sm text-[#FF9F9F]",children:ev.signature.name.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(h.J,{htmlFor:"signature.date",className:"text-[rgba(207,207,207,0.75)]",children:"Date"}),(0,r.jsx)(p.p,{id:"signature.date",...ex("signature.date"),placeholder:new Date().toLocaleDateString(),className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.8)] text-white placeholder:text-[rgba(207,207,207,0.35)] focus:border-[rgba(75,142,255,0.45)]",onKeyDown:e=>{"Enter"===e.key&&e.preventDefault()}}),(null==(b=ev.signature)?void 0:b.date)&&(0,r.jsx)("p",{className:"text-sm text-[#FF9F9F]",children:ev.signature.date.message})]})]}),(0,r.jsxs)("div",{className:"mt-6 rounded-2xl border border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.65)] p-6",children:[(0,r.jsx)("h4",{className:"mb-4 text-lg font-semibold text-white",children:"Report Summary"}),(0,r.jsxs)("div",{className:"space-y-3 text-sm text-[rgba(207,207,207,0.7)]",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-white font-medium",children:"Template:"}),(0,r.jsx)("p",{className:"mt-1",children:eT.templateTitle||"(Untitled Template)"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-white font-medium",children:"Patient Data:"}),(0,r.jsx)("p",{className:"mt-1",children:"Included"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-white font-medium",children:"Indication:"}),(0,r.jsx)("p",{className:"mt-1 whitespace-pre-wrap break-words",children:eg("indication")||"Not provided"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-white font-medium",children:"Findings:"}),(0,r.jsx)("p",{className:"mt-1 whitespace-pre-wrap break-words",children:eg("findings")||"Not provided"})]})]})]}),(0,r.jsx)("div",{className:"mt-6 rounded-2xl border border-[rgba(75,142,255,0.35)] bg-[rgba(12,16,28,0.6)] p-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(I.A,{className:"h-5 w-5 text-[#7AE7B4]"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-white",children:"Ready to Generate"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(207,207,207,0.7)]",children:"Review the details above and click “Generate Report” when you're ready."})]})]})})]})]})})]},G)}),(0,r.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 mt-6 flex items-center justify-between bg-[rgba(6,10,18,0.98)] backdrop-blur-md px-4 py-3 text-white md:static md:bg-transparent md:p-0 md:mt-6 z-20 safe-area-inset-bottom",children:[(0,r.jsx)(m.$,{type:"button",variant:"ghost",onClick:eR,disabled:1===G,className:(0,V.cn)("flex items-center justify-center rounded-full w-12 h-12 bg-[rgba(18,22,36,0.8)] border border-[rgba(255,255,255,0.12)] text-white hover:bg-[rgba(75,142,255,0.2)] hover:border-[rgba(75,142,255,0.4)] transition-all",1===G&&"opacity-40 cursor-not-allowed"),"aria-label":"Previous step",children:(0,r.jsx)(T.A,{className:"w-6 h-6"})}),(0,r.jsx)("div",{className:"flex items-center gap-3",children:G<4?(0,r.jsx)(m.$,{type:"button",onClick:eE,className:"flex items-center justify-center rounded-full w-12 h-12 bg-[#2653FF] hover:bg-[#4B8EFF] text-white transition-all","aria-label":"Next step",children:(0,r.jsx)(P.A,{className:"w-6 h-6"})}):(0,r.jsx)(m.$,{type:"submit",disabled:K||eN||(null==ep?void 0:ep.subscription)&&ep.subscription.reports_used>=ep.subscription.reports_limit,className:"flex items-center justify-center gap-2 rounded-full px-6 h-12 bg-[#3FBF8C] hover:bg-[#6EE7B7] text-white font-semibold transition-all disabled:opacity-60",onClick:()=>{ea(!0)},children:K||eN?"Generating...":"Generate Report"})})]})]}),(0,r.jsx)(Q,{open:er,onClose:()=>es(!1),currentTier:el,reason:ei,onUpgrade:()=>{es(!1),f.push("/pricing")}}),(K||eN)&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-[rgba(4,8,18,0.95)] backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"relative w-full max-w-md mx-4 rounded-3xl border border-[rgba(75,142,255,0.3)] bg-gradient-to-br from-[rgba(12,16,28,0.98)] to-[rgba(5,8,16,0.95)] px-8 py-10 text-center shadow-2xl",children:[(0,r.jsx)("div",{className:"absolute inset-0 rounded-3xl bg-gradient-to-br from-[rgba(75,142,255,0.08)] to-transparent opacity-50 pointer-events-none"}),(0,r.jsxs)("div",{className:"relative space-y-6",children:[(0,r.jsx)("div",{className:"mx-auto flex h-20 w-20 items-center justify-center rounded-full border border-[rgba(75,142,255,0.3)] bg-[rgba(12,16,28,0.9)] shadow-lg",children:(0,r.jsx)("div",{className:"h-12 w-12 rounded-full border-3 border-[rgba(143,130,255,0.3)] border-t-[rgba(143,130,255,0.9)] animate-spin",style:{borderWidth:"3px"}})}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("p",{className:"text-xs font-semibold uppercase tracking-widest text-[rgba(207,207,207,0.5)]",children:"Assistant at work"}),(0,r.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold text-white",children:"Generating your radiology report"}),(0,r.jsx)("p",{className:"text-sm text-[rgba(207,207,207,0.75)] max-w-sm mx-auto",children:"Radly is aligning findings, impressions, and follow-up recommendations. You'll review the draft in just a moment."})]})]})]})})]})})}},86948:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>n,aR:()=>l});var r=a(95155),s=a(12115),i=a(64269);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});n.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...s})});l.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},91162:(e,t,a)=>{"use strict";a.d(t,{Sk:()=>s,b6:()=>i,eU:()=>n});var r=a(62890);async function s(e){try{var t,a,s;let i=(0,r.A)(),{data:{user:n},error:l}=await i.auth.getUser();if(l||!n)throw Error("User not found");return{id:e,email:n.email||"",default_signature_name:(null==(t=n.user_metadata)?void 0:t.default_signature_name)||"",default_signature_date_format:(null==(a=n.user_metadata)?void 0:a.default_signature_date_format)||"MM/DD/YYYY",accepted_terms_at:null==(s=n.user_metadata)?void 0:s.accepted_terms_at,subscription:null,updated_at:n.updated_at||new Date().toISOString()}}catch(t){return{id:e,email:"",default_signature_name:"",default_signature_date_format:"MM/DD/YYYY",subscription:null,updated_at:new Date().toISOString()}}}async function i(e,t){try{let e=(0,r.A)(),{error:a}=await e.auth.updateUser({data:{default_signature_name:t.default_signature_name,default_signature_date_format:t.default_signature_date_format,accepted_terms_at:t.accepted_terms_at}});if(a)throw Error("Failed to update user data: ".concat(a.message))}catch(e){throw e}}let n={retry:(e,t)=>!(t.message.includes("401")||t.message.includes("403")||t.message.includes("404"))&&e<2,retryDelay:e=>Math.min(1e3*2**e,3e4),staleTime:3e5}}},e=>{e.O(0,[5707,2619,8727,4230,1733,6743,2149,2454,6692,1691,2615,3677,635,7815,8441,1255,7358],()=>e(e.s=66249)),_N_E=e.O()}]);