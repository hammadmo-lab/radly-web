(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3698],{11647:(e,r,s)=>{"use strict";s.d(r,{E:()=>i});var a=s(95155);s(12115);var t=s(83101),n=s(64269);let l=(0,t.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:r,variant:s,...t}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:s}),r),...t})}},52079:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>er});var a=s(95155),t=s(12115),n=s(20063),l=s(91169),i=s(1524),o=s(91761),c=s(16485),d=s(17910),x=s(80534),b=s(84926),h=s(6132),m=s(3998),u=s(16041),g=s(1733),p=s(64269);function f(e){let{title:r,value:s,icon:t,trend:n,description:l}=e,i=n?n.isPositive?"border-[rgba(63,191,140,0.42)] bg-[rgba(63,191,140,0.18)] text-[#C8F3E2]":"border-[rgba(255,107,107,0.35)] bg-[rgba(255,107,107,0.18)] text-[#FFD1D1]":"";return(0,a.jsx)(g.P.div,{initial:{opacity:0,y:24},animate:{opacity:1,y:0},transition:{duration:.35,ease:"easeOut"},children:(0,a.jsx)("div",{className:"aurora-card border border-[rgba(255,255,255,0.08)] p-5 sm:p-6 backdrop-blur-xl transition-all duration-300 hover:-translate-y-1 hover:border-[rgba(75,142,255,0.35)] hover:shadow-[0_18px_42px_rgba(20,28,45,0.5)]",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"flex h-11 w-11 items-center justify-center rounded-2xl bg-[linear-gradient(135deg,#2653FF_0%,#4B8EFF_50%,#8F82FF_100%)] shadow-[0_18px_42px_rgba(52,84,207,0.42)]",children:(0,a.jsx)(t,{className:"h-5 w-5 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-[rgba(207,207,207,0.55)]",children:r}),(0,a.jsx)("p",{className:"text-3xl font-semibold leading-tight text-white",children:s})]})]}),l&&(0,a.jsx)("p",{className:"max-w-[18rem] text-xs text-[rgba(207,207,207,0.6)]",children:l})]}),n&&(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2 text-right",children:[(0,a.jsx)("span",{className:(0,p.cn)("rounded-full border px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.22em]",i),children:n.isPositive?"Stable":"Watch"}),(0,a.jsxs)("span",{className:(0,p.cn)("text-lg font-semibold",n.isPositive?"text-[#7AE7B4]":"text-[#FF9F9F]"),children:[n.isPositive?"+":"-",Math.abs(n.value),"%"]}),(0,a.jsx)("span",{className:"text-[10px] text-[rgba(207,207,207,0.45)]",children:"vs last month"})]})]})})})}var v=s(89559),j=s(39867),N=s(86651),w=s(57828),y=s(90368),F=s(27937),k=s(65142),C=s(11647),E=s(86948),D=s(11186);let _=t.forwardRef((e,r)=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:r,className:(0,p.cn)("w-full caption-bottom text-sm",s),...t})})});_.displayName="Table";let A=t.forwardRef((e,r)=>{let{className:s,...t}=e;return(0,a.jsx)("thead",{ref:r,className:(0,p.cn)("[&_tr]:border-b",s),...t})});A.displayName="TableHeader";let R=t.forwardRef((e,r)=>{let{className:s,...t}=e;return(0,a.jsx)("tbody",{ref:r,className:(0,p.cn)("[&_tr:last-child]:border-0",s),...t})});R.displayName="TableBody",t.forwardRef((e,r)=>{let{className:s,...t}=e;return(0,a.jsx)("tfoot",{ref:r,className:(0,p.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t})}).displayName="TableFooter";let B=t.forwardRef((e,r)=>{let{className:s,...t}=e;return(0,a.jsx)("tr",{ref:r,className:(0,p.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t})});B.displayName="TableRow";let S=t.forwardRef((e,r)=>{let{className:s,...t}=e;return(0,a.jsx)("th",{ref:r,className:(0,p.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...t})});S.displayName="TableHead";let T=t.forwardRef((e,r)=>{let{className:s,...t}=e;return(0,a.jsx)("td",{ref:r,className:(0,p.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...t})});T.displayName="TableCell",t.forwardRef((e,r)=>{let{className:s,...t}=e;return(0,a.jsx)("caption",{ref:r,className:(0,p.cn)("mt-4 text-sm text-muted-foreground",s),...t})}).displayName="TableCaption";var L=s(20243);function P(e){let{used:r,limit:s,className:t=""}=e,n=Math.min(r/Math.max(s,1)*100,100),l=n>90?"bg-[linear-gradient(90deg,#FF6B6B_0%,#FF9F6B_100%)] shadow-[0_8px_18px_rgba(255,107,107,0.32)]":n>70?"bg-[linear-gradient(90deg,#F8B74D_0%,#FF8A4F_100%)] shadow-[0_8px_18px_rgba(248,183,77,0.26)]":"bg-[linear-gradient(90deg,#3FBF8C_0%,#6EE7B7_100%)] shadow-[0_8px_18px_rgba(63,191,140,0.32)]";return(0,a.jsxs)("div",{className:"space-y-3 ".concat(t),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs uppercase tracking-[0.12em] text-[rgba(207,207,207,0.55)]",children:[(0,a.jsxs)("span",{children:[r," / ",s]}),(0,a.jsxs)("span",{children:[n.toFixed(0),"%"]})]}),(0,a.jsxs)("div",{className:"relative h-2.5 w-full overflow-hidden rounded-full border border-[rgba(255,255,255,0.08)] bg-[rgba(18,22,36,0.85)]",children:[(0,a.jsx)(g.P.div,{className:"h-full rounded-full ".concat(l),initial:{width:0},animate:{width:"".concat(n,"%")},transition:{duration:.5,ease:"easeOut"}}),(0,a.jsx)("div",{className:"pointer-events-none absolute inset-0 rounded-full bg-white/5 mix-blend-screen opacity-40"})]})]})}var I=s(40470);let M={active:"border-[rgba(63,191,140,0.35)] bg-[rgba(63,191,140,0.18)] text-[#C8F3E2]",cancelled:"border-[rgba(255,107,107,0.32)] bg-[rgba(255,107,107,0.18)] text-[#FFD1D1]",expired:"border-[rgba(207,207,207,0.2)] bg-[rgba(18,22,36,0.75)] text-[rgba(207,207,207,0.7)]"},$={free:"border-[rgba(207,207,207,0.18)] bg-[rgba(207,207,207,0.08)] text-[rgba(207,207,207,0.75)]",starter:"border-[rgba(75,142,255,0.35)] bg-[rgba(75,142,255,0.16)] text-[#D7E3FF]",professional:"border-[rgba(143,130,255,0.35)] bg-[rgba(143,130,255,0.16)] text-[#E2DAFF]",premium:"border-[rgba(248,183,77,0.35)] bg-[rgba(248,183,77,0.16)] text-[#FBE3B5]"};function U(e){let{subscriptions:r,isLoading:s,total:n,currentPage:i,pageSize:o,onPageChange:c,onSearch:d,onFilterChange:x,onRefresh:b,onExport:h,onViewUser:u}=e,[f,U]=(0,t.useState)(""),z=(0,t.useMemo)(()=>(null==r?void 0:r.map(e=>e.user_id).filter(Boolean))||[],[r]),{data:W,isLoading:V}=(0,I.I)(z),O=Math.max(1,Math.ceil(n/Math.max(o,1))),q=n>0,H=q?(i-1)*o+1:0,Y=q?Math.min(i*o,n):0;return(0,a.jsxs)(E.Zp,{className:"aurora-card border border-[rgba(255,255,255,0.08)] backdrop-blur-xl",children:[(0,a.jsxs)(E.aR,{className:"space-y-6 border-b border-[rgba(255,255,255,0.06)] p-6 pb-5",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-5 sm:flex-row sm:items-start sm:justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-[linear-gradient(135deg,#2653FF_0%,#4B8EFF_55%,#8F82FF_100%)] shadow-[0_22px_48px_rgba(52,84,207,0.38)]",children:(0,a.jsx)(l.A,{className:"h-5 w-5 text-white"})}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Subscriptions"}),(0,a.jsxs)("p",{className:"text-sm text-[rgba(207,207,207,0.65)]",children:["Tracking ",n," customer plans across tiers"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:[(0,a.jsxs)(m.$,{variant:"ghost",size:"sm",onClick:b,className:"h-10 border border-[rgba(255,255,255,0.12)] text-[rgba(207,207,207,0.85)] hover:border-[#4B8EFF]/40 hover:text-white",children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Refresh"]}),(0,a.jsxs)(m.$,{variant:"ghost",size:"sm",onClick:h,className:"h-10 border border-[rgba(75,142,255,0.35)] bg-[rgba(75,142,255,0.16)] text-[#D7E3FF] hover:border-[rgba(75,142,255,0.45)] hover:bg-[rgba(75,142,255,0.22)]",children:[(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Export CSV"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(N.A,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-[rgba(207,207,207,0.45)]"}),(0,a.jsx)(k.p,{placeholder:"Search by email, user ID, or plan...",value:f,onChange:e=>{var r;U(r=e.target.value),d(r)},className:"h-12 rounded-xl border-[rgba(255,255,255,0.12)] bg-[rgba(18,22,36,0.85)] pl-12 text-white placeholder:text-[rgba(207,207,207,0.45)] focus-visible:ring-[#4B8EFF]"})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:flex-wrap sm:items-center",children:[(0,a.jsxs)(D.l6,{onValueChange:e=>x("status","all"===e?"":e),children:[(0,a.jsx)(D.bq,{className:"h-11 min-w-[140px] rounded-xl border-[rgba(255,255,255,0.12)] bg-[rgba(18,22,36,0.85)] text-[rgba(207,207,207,0.75)] hover:border-[#4B8EFF]/40",children:(0,a.jsx)(D.yv,{placeholder:"Status"})}),(0,a.jsxs)(D.gC,{className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,14,24,0.95)] text-white",children:[(0,a.jsx)(D.eb,{value:"all",children:"All Status"}),(0,a.jsx)(D.eb,{value:"active",children:"Active"}),(0,a.jsx)(D.eb,{value:"cancelled",children:"Cancelled"}),(0,a.jsx)(D.eb,{value:"expired",children:"Expired"})]})]}),(0,a.jsxs)(D.l6,{onValueChange:e=>x("tier","all"===e?"":e),children:[(0,a.jsx)(D.bq,{className:"h-11 min-w-[140px] rounded-xl border-[rgba(255,255,255,0.12)] bg-[rgba(18,22,36,0.85)] text-[rgba(207,207,207,0.75)] hover:border-[#4B8EFF]/40",children:(0,a.jsx)(D.yv,{placeholder:"Tier"})}),(0,a.jsxs)(D.gC,{className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,14,24,0.95)] text-white",children:[(0,a.jsx)(D.eb,{value:"all",children:"All Tiers"}),(0,a.jsx)(D.eb,{value:"free",children:"Free"}),(0,a.jsx)(D.eb,{value:"starter",children:"Starter"}),(0,a.jsx)(D.eb,{value:"professional",children:"Professional"}),(0,a.jsx)(D.eb,{value:"premium",children:"Premium"})]})]}),(0,a.jsxs)(D.l6,{onValueChange:e=>x("region","all"===e?"":e),children:[(0,a.jsx)(D.bq,{className:"h-11 min-w-[140px] rounded-xl border-[rgba(255,255,255,0.12)] bg-[rgba(18,22,36,0.85)] text-[rgba(207,207,207,0.75)] hover:border-[#4B8EFF]/40",children:(0,a.jsx)(D.yv,{placeholder:"Region"})}),(0,a.jsxs)(D.gC,{className:"border border-[rgba(255,255,255,0.12)] bg-[rgba(12,14,24,0.95)] text-white",children:[(0,a.jsx)(D.eb,{value:"all",children:"All Regions"}),(0,a.jsx)(D.eb,{value:"egypt",children:"Egypt"}),(0,a.jsx)(D.eb,{value:"international",children:"International"})]})]})]})]})]}),(0,a.jsx)(E.Wu,{className:"space-y-6 p-6",children:s?(0,a.jsx)("div",{className:"space-y-4",children:Array.from({length:5}).map((e,r)=>(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(L.E,{className:"h-4 w-[240px] rounded bg-[rgba(255,255,255,0.08)]"}),(0,a.jsx)(L.E,{className:"h-4 w-[110px] rounded bg-[rgba(255,255,255,0.08)]"}),(0,a.jsx)(L.E,{className:"h-4 w-[90px] rounded bg-[rgba(255,255,255,0.08)]"}),(0,a.jsx)(L.E,{className:"h-4 w-[140px] rounded bg-[rgba(255,255,255,0.08)]"}),(0,a.jsx)(L.E,{className:"h-4 w-[120px] rounded bg-[rgba(255,255,255,0.08)]"})]},r))}):0===r.length?(0,a.jsxs)("div",{className:"aurora-card border border-dashed border-[rgba(255,255,255,0.12)] bg-[rgba(12,16,28,0.65)] py-12 text-center",children:[(0,a.jsx)("div",{className:"mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full border border-[rgba(75,142,255,0.35)] bg-[rgba(75,142,255,0.16)] text-[#D7E3FF]",children:(0,a.jsx)(l.A,{className:"h-6 w-6"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-white",children:"No subscriptions match that view"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-[rgba(207,207,207,0.65)]",children:"Adjust your filters or search query to see more customers."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"overflow-hidden rounded-2xl border border-[rgba(255,255,255,0.06)] bg-[rgba(12,16,28,0.55)]",children:(0,a.jsxs)(_,{children:[(0,a.jsx)(A,{className:"bg-[rgba(12,16,28,0.72)]",children:(0,a.jsx)(B,{className:"border-b border-[rgba(255,255,255,0.06)]",children:["User","Tier","Status","Usage","Revenue","Period End","Actions"].map(e=>(0,a.jsx)(S,{className:"px-6 py-4 text-[11px] font-semibold uppercase tracking-[0.18em] text-[rgba(207,207,207,0.45)]",children:e},e))})}),(0,a.jsx)(R,{children:r.map(e=>(0,a.jsxs)(g.P.tr,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.25},className:"border-b border-[rgba(255,255,255,0.05)] bg-transparent last:border-none hover:bg-[rgba(75,142,255,0.08)]",children:[(0,a.jsx)(T,{className:"px-6 py-5 text-sm text-white",children:(0,a.jsxs)("div",{className:"min-w-[200px] space-y-2",children:[(0,a.jsx)("div",{className:"font-medium",children:V?(0,a.jsx)("span",{className:"animate-pulse text-[rgba(207,207,207,0.55)]",children:"Loading email…"}):(null==W?void 0:W[e.user_id])&&W[e.user_id].includes("@")?(0,a.jsx)("span",{title:W[e.user_id],children:W[e.user_id]}):(0,a.jsx)("span",{className:"text-[rgba(207,207,207,0.55)]",children:(null==W?void 0:W[e.user_id])||"Email unavailable"})}),(0,a.jsxs)("div",{className:"font-mono text-[11px] uppercase tracking-[0.18em] text-[rgba(207,207,207,0.45)]",title:e.user_id,children:["ID:"," ",e.user_id?"".concat(e.user_id.substring(0,8),"…"):"N/A"]})]})}),(0,a.jsx)(T,{className:"px-6 py-5",children:(e=>{var r;let s=null!=(r=null==e?void 0:e.toLowerCase())?r:"free",t=$[s]||$.free;return(0,a.jsx)(C.E,{className:(0,p.cn)("border px-2.5 py-0.5 text-xs font-semibold uppercase tracking-[0.14em] bg-transparent",t),children:s.charAt(0).toUpperCase()+s.slice(1)})})(e.tier_name)}),(0,a.jsx)(T,{className:"px-6 py-5",children:(e=>{var r;let s=null!=(r=null==e?void 0:e.toLowerCase())?r:"expired",t=M[s]||M.expired;return(0,a.jsx)(C.E,{className:(0,p.cn)("border px-2.5 py-0.5 text-xs font-semibold uppercase tracking-[0.14em] bg-transparent",t),children:s.charAt(0).toUpperCase()+s.slice(1)})})(e.status)}),(0,a.jsx)(T,{className:"px-6 py-5",children:(0,a.jsx)(P,{used:e.reports_used_current_period,limit:e.reports_limit})}),(0,a.jsxs)(T,{className:"px-6 py-5 text-sm text-[rgba(207,207,207,0.75)]",children:[e.currency," ",e.price_paid]}),(0,a.jsx)(T,{className:"px-6 py-5 text-sm text-[rgba(207,207,207,0.75)]",children:new Date(e.period_end).toLocaleDateString()}),(0,a.jsx)(T,{className:"px-6 py-5",children:(0,a.jsxs)(m.$,{variant:"ghost",size:"sm",onClick:()=>u(e.user_id),disabled:!e.user_id,className:"h-9 border border-transparent text-[#D7E3FF] hover:border-[rgba(75,142,255,0.35)] hover:bg-[rgba(75,142,255,0.12)]",children:[(0,a.jsx)(w.A,{className:"mr-2 h-4 w-4"}),"View Details"]})})]},e.subscription_id))})]})}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 text-sm text-[rgba(207,207,207,0.55)] sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsx)("div",{children:q?"Showing ".concat(H,"-").concat(Y," of ").concat(n," results"):"No matching subscriptions"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>c(i-1),disabled:1===i,className:"h-9 border border-[rgba(255,255,255,0.12)] text-[rgba(207,207,207,0.8)] disabled:border-transparent disabled:text-[rgba(207,207,207,0.3)]",children:(0,a.jsx)(y.A,{className:"h-4 w-4"})}),(0,a.jsxs)("span",{className:"text-xs uppercase tracking-[0.18em] text-[rgba(207,207,207,0.45)]",children:["Page ",i," of ",O]}),(0,a.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>c(i+1),disabled:i===O,className:"h-9 border border-[rgba(255,255,255,0.12)] text-[rgba(207,207,207,0.8)] disabled:border-transparent disabled:text-[rgba(207,207,207,0.3)]",children:(0,a.jsx)(F.A,{className:"h-4 w-4"})})]})]})]})})]})}var z=s(52056),W=s(65993),V=s(18720);class O extends t.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){this.setState({error:e,errorInfo:r}),V.oR.error("An unexpected error occurred in the admin dashboard")}render(){if(this.state.hasError){if(this.props.fallback)return this.props.fallback;let e=this.state.retryCount<this.maxRetries,r=this.getErrorMessage(this.state.error);return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50 via-white to-violet-50 flex items-center justify-center p-4",children:(0,a.jsxs)(E.Zp,{className:"w-full max-w-md",children:[(0,a.jsxs)(E.aR,{className:"text-center",children:[(0,a.jsx)("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)(z.A,{className:"w-6 h-6 text-red-600"})}),(0,a.jsx)(E.ZB,{className:"text-xl font-semibold text-gray-900",children:"Admin Dashboard Error"}),(0,a.jsx)(E.BT,{className:"text-gray-600",children:r})]}),(0,a.jsxs)(E.Wu,{className:"space-y-4",children:[!1,(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[e&&(0,a.jsxs)(m.$,{onClick:this.handleRetry,className:"w-full",variant:"default",children:[(0,a.jsx)(v.A,{className:"w-4 h-4 mr-2"}),"Try Again (",this.state.retryCount+1,"/",this.maxRetries,")"]}),(0,a.jsxs)(m.$,{onClick:this.handleReset,variant:"outline",className:"w-full",children:[(0,a.jsx)(W.A,{className:"w-4 h-4 mr-2"}),"Reset Dashboard"]})]})]})]})})}return this.props.children}getErrorMessage(e){if(!e)return"An unexpected error occurred";let r=e.message.toLowerCase();if(r.includes("401"))return"Authentication failed. Please check your admin credentials.";if(r.includes("403"))return"Access forbidden. You do not have permission to access this resource.";if(r.includes("404"))return"Resource not found. The requested data may have been moved or deleted.";if(r.includes("503"))return"Service temporarily unavailable. Please try again later.";if(r.includes("network")||r.includes("fetch"))return"Network error. Please check your internet connection and try again.";else return"An unexpected error occurred. Please try refreshing the page."}constructor(e){super(e),this.maxRetries=3,this.handleRetry=()=>{this.state.retryCount<this.maxRetries?(this.setState(e=>({hasError:!1,error:null,errorInfo:null,retryCount:e.retryCount+1})),V.oR.info("Retrying... (".concat(this.state.retryCount+1,"/").concat(this.maxRetries,")"))):V.oR.error("Maximum retry attempts reached")},this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null,retryCount:0}),V.oR.success("Error boundary reset")},this.state={hasError:!1,error:null,errorInfo:null,retryCount:0}}}var q=s(42529),H=s(78874),Y=s(33738);let Z={connected:{icon:q.A,iconWrapper:"border-[rgba(63,191,140,0.35)] bg-[rgba(63,191,140,0.16)] text-[#7AE7B4]",iconClass:"text-[#7AE7B4]",badgeClass:"border-[rgba(63,191,140,0.35)] text-[#C8F3E2]",label:"Connected"},checking:{icon:v.A,iconWrapper:"border-[rgba(248,183,77,0.35)] bg-[rgba(248,183,77,0.16)] text-[#FBE3B5]",iconClass:"text-[#FBE3B5]",badgeClass:"border-[rgba(248,183,77,0.35)] text-[#FBE3B5]",label:"Checking…",spin:!0},error:{icon:z.A,iconWrapper:"border-[rgba(255,107,107,0.32)] bg-[rgba(255,107,107,0.18)] text-[#FFD1D1]",iconClass:"text-[#FFD1D1]",badgeClass:"border-[rgba(255,107,107,0.32)] text-[#FFD1D1]",label:"Connection Error"},disconnected:{icon:H.A,iconWrapper:"border-[rgba(255,107,107,0.32)] bg-[rgba(255,107,107,0.18)] text-[#FFD1D1]",iconClass:"text-[#FFD1D1]",badgeClass:"border-[rgba(255,107,107,0.32)] text-[#FFD1D1]",label:"Disconnected"},offline:{icon:Y.A,iconWrapper:"border-[rgba(255,107,107,0.32)] bg-[rgba(255,107,107,0.18)] text-[#FFD1D1]",iconClass:"text-[#FFD1D1]",badgeClass:"border-[rgba(255,107,107,0.32)] text-[#FFD1D1]",label:"Offline"}},G=e=>e?"".concat(e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})):"Never";function Q(e){var r,s,n;let{baseUrl:l="https://edge.radly.app",checkInterval:i=3e4,showDetails:o=!1,className:c=""}=e,[d,x]=(0,t.useState)("checking"),[b,h]=(0,t.useState)(null),[u,g]=(0,t.useState)(""),[f,j]=(0,t.useState)(null),[N,w]=(0,t.useState)(!0),y=null!=(r=Z[N?d:"offline"])?r:Z.error,F=y.icon,k=(0,t.useCallback)(async()=>{try{x("checking"),g("");let e=new AbortController,r=setTimeout(()=>e.abort(),1e4),s=await fetch("".concat(l,"/health"),{method:"GET",signal:e.signal,headers:{"Content-Type":"application/json","X-Request-Id":crypto.randomUUID()}});if(clearTimeout(r),s.ok){let e=await s.json();j(e),x("connected"),h(new Date),"unhealthy"===e.status&&V.oR.warning("Backend service is reporting as unhealthy")}else throw Error("Health check failed with status ".concat(s.status))}catch(r){let e=r instanceof Error?r.message:"Unknown error";g(e),x("error"),h(new Date),e.includes("aborted")||e.includes("timeout")?V.oR.error("Connection timeout - backend may be slow to respond"):e.includes("Failed to fetch")?V.oR.error("Cannot connect to backend server"):V.oR.error("Connection error: ".concat(e))}},[l]),E=(0,t.useCallback)(()=>{"checking"!==d&&k()},[k,d]);(0,t.useEffect)(()=>{k();let e=setInterval(k,i);return()=>clearInterval(e)},[k,i]),(0,t.useEffect)(()=>{let e=()=>{w(!0),k()},r=()=>{w(!1),x("disconnected"),V.oR.error("You are offline")};return window.addEventListener("online",e),window.addEventListener("offline",r),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",r)}},[k]);let D=N&&"error"!==d&&"disconnected"!==d?null:(s=N,n=u,s?J(n):"Offline mode: the app cannot reach the backend. Reconnect to the internet and retry.");return(0,a.jsxs)("div",{className:(0,p.cn)("aurora-card border border-[rgba(255,255,255,0.08)] p-5 sm:p-6 backdrop-blur-xl transition-colors",c),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:(0,p.cn)("flex h-12 w-12 items-center justify-center rounded-2xl border",y.iconWrapper),children:(0,a.jsx)(F,{className:(0,p.cn)("h-5 w-5",y.iconClass,y.spin?"animate-spin":void 0)})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,a.jsx)("span",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-[rgba(207,207,207,0.55)]",children:"Backend Link"}),(0,a.jsx)(C.E,{className:(0,p.cn)("border px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] bg-transparent",y.badgeClass),children:(()=>{if(!N)return"Offline";switch(d){case"connected":return(null==f?void 0:f.status)==="unhealthy"?"Service Degraded":"Connected";case"disconnected":return"Disconnected";case"checking":return"Checking…";case"error":return"Connection Error";default:return"Unknown"}})()}),(null==f?void 0:f.status)==="unhealthy"&&(0,a.jsx)(C.E,{className:"border-[rgba(255,183,77,0.4)] bg-[rgba(255,183,77,0.12)] px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.22em] text-[#FBE3B5]",children:"Unhealthy"})]}),(0,a.jsx)("p",{className:"text-sm text-[rgba(207,207,207,0.65)]",children:N?"connected"===d?(null==f?void 0:f.status)==="unhealthy"?"The service responded but flagged itself as unhealthy.":"Backend responded within acceptable thresholds.":"checking"===d?"Pinging the /health endpoint…":"disconnected"===d?"No response from the backend service.":u?J(u):"Encountered an unexpected error while checking the backend.":"You appear to be offline. Check your network connection."}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4 text-[11px] uppercase tracking-[0.18em] text-[rgba(207,207,207,0.45)]",children:[(0,a.jsxs)("span",{children:["Last check: ",G(b)]}),(0,a.jsx)("span",{children:"Endpoint: /health"}),(null==f?void 0:f.version)&&(0,a.jsxs)("span",{children:["Build ",f.version]})]})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2 self-start",children:(0,a.jsxs)(m.$,{variant:"ghost",size:"sm",onClick:E,disabled:"checking"===d,className:"border border-[rgba(255,255,255,0.12)] text-[rgba(207,207,207,0.8)] hover:border-[#4B8EFF]/40 hover:text-white",children:[(0,a.jsx)(v.A,{className:(0,p.cn)("mr-2 h-4 w-4","checking"===d?"animate-spin":void 0)}),"Retry"]})})]}),D&&(0,a.jsx)("div",{className:"mt-4 rounded-xl border border-[rgba(255,107,107,0.28)] bg-[rgba(255,107,107,0.12)] p-4 text-sm text-[#FFD1D1]",children:D}),o&&f&&(0,a.jsxs)("div",{className:"mt-4 grid gap-4 rounded-xl border border-[rgba(255,255,255,0.06)] bg-[rgba(12,16,28,0.65)] p-4 text-sm text-[rgba(207,207,207,0.65)] sm:grid-cols-2",children:[(0,a.jsx)(X,{label:"Reported Status",value:f.status}),(0,a.jsx)(X,{label:"Reported At",value:new Date(f.timestamp).toLocaleString()}),(0,a.jsx)(X,{label:"API Base",value:l}),(0,a.jsx)(X,{label:"Last Check",value:G(b)})]})]})}function X(e){let{label:r,value:s}=e;return s?(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-[11px] uppercase tracking-[0.16em] text-[rgba(207,207,207,0.45)]",children:r}),(0,a.jsx)("p",{className:"text-sm text-white",children:s})]}):null}function J(e){return e.includes("timeout")||e.includes("aborted")?"Connection timeout. The backend server may be slow to respond.":e.includes("Failed to fetch")?"Cannot connect to the backend server. Please check if the service is running.":e.includes("401")?"Authentication failed. Please check your admin credentials.":e.includes("403")?"Access forbidden. You do not have permission to access the health endpoint.":e.includes("404")?"Health endpoint not found. The backend may not support health checks.":e.includes("503")?"Service temporarily unavailable. The backend server is experiencing issues.":e||"Unknown connection error occurred."}var K=s(37723),ee=s(8279);function er(){var e,r;let s=(0,n.useRouter)(),{logout:g}=(0,K.b)(),[p,v]=(0,t.useState)({limit:10,offset:0}),[j,N]=(0,t.useState)(1),{data:w,isLoading:y,error:F,refetch:k}=(0,ee.Q2)(p),{data:C,isLoading:E,error:D}=(0,ee.gj)(30),_=F||D,A=(0,t.useCallback)(e=>{v(r=>({...r,search:e,offset:0})),N(1)},[]),R=(0,t.useCallback)((e,r)=>{v(s=>({...s,[e]:r||void 0,offset:0})),N(1)},[]),B=(0,t.useCallback)(e=>{let r=(e-1)*(p.limit||10);v(e=>({...e,offset:r})),N(e)},[p.limit]),S=(0,t.useCallback)(()=>{k(),V.oR.success("Data refreshed")},[k]),T=(0,t.useCallback)(()=>{V.oR.info("CSV export feature coming soon")},[]),L=(0,t.useCallback)(e=>{if(!e)return void V.oR.error("Cannot view user: user ID not available");s.push("/admin/users?userId=".concat(e))},[s]),P=(0,t.useCallback)(()=>{g(),s.push("/admin/login"),V.oR.success("Logged out successfully")},[g,s]);(0,t.useEffect)(()=>{F&&V.oR.error("Failed to load subscriptions: ".concat(F.message))},[F]),(0,t.useEffect)(()=>{D&&V.oR.error("Failed to load revenue analytics: ".concat(D.message))},[D]);let I=[{title:"Total Subscriptions",value:y?"...":(null==w?void 0:w.total)||0,icon:l.A,description:"All time subscriptions",isLoading:y},{title:"Active Subscriptions",value:y?"...":(null==w||null==(e=w.subscriptions)?void 0:e.filter(e=>"active"===e.status).length)||0,icon:i.A,description:"Currently active",isLoading:y},{title:"Monthly Revenue",value:E?"...":null==(r=null==C?void 0:C.total_revenue)||isNaN(r)?"$0":"$".concat(r.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})),icon:o.A,description:"This month",isLoading:E},{title:"New Users (7 days)",value:"12",icon:c.A,description:"New signups this week",isLoading:!1}],M=F?"Failed to load subscriptions: ".concat(F.message):D?"Failed to load revenue data: ".concat(D.message):"";return(0,a.jsx)(u.f,{children:(0,a.jsx)(O,{children:(0,a.jsx)("div",{className:"min-h-screen bg-[var(--ds-bg-gradient)] text-white",children:(0,a.jsx)("div",{className:"relative mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 py-12 neon-page-stack",children:(0,a.jsxs)("div",{className:"neon-shell space-y-8 p-6 sm:p-8 md:p-10 backdrop-blur-xl",children:[(0,a.jsx)(Q,{className:"border border-[rgba(75,142,255,0.18)]"}),(0,a.jsxs)("header",{className:"flex flex-col gap-6 md:flex-row md:items-start md:justify-between",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-[linear-gradient(135deg,#2653FF_0%,#4B8EFF_55%,#8F82FF_100%)] shadow-[0_22px_48px_rgba(52,84,207,0.38)]",children:(0,a.jsx)(d.A,{className:"h-6 w-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-[rgba(207,207,207,0.55)]",children:"Radly Control Room"}),(0,a.jsx)("h1",{className:"text-3xl font-semibold text-white",children:"Admin Dashboard"})]})]}),(0,a.jsx)("p",{className:"max-w-xl text-sm text-[rgba(207,207,207,0.65)]",children:"Monitor subscription health, revenue, and customer usage without leaving the neon shell."})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:[(0,a.jsxs)(m.$,{variant:"ghost",onClick:()=>s.push("/admin/metrics"),className:"h-11 rounded-xl border border-[rgba(75,142,255,0.35)] bg-[rgba(75,142,255,0.16)] px-5 text-[#D7E3FF] hover:border-[rgba(75,142,255,0.45)] hover:bg-[rgba(75,142,255,0.22)]",children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Metrics Dashboard"]}),(0,a.jsxs)(m.$,{variant:"ghost",onClick:P,className:"h-11 rounded-xl border border-[rgba(255,255,255,0.12)] px-5 text-[rgba(207,207,207,0.8)] hover:border-[rgba(255,107,107,0.32)] hover:text-[#FFD1D1]",children:[(0,a.jsx)(b.A,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]}),_&&(0,a.jsx)("div",{className:"rounded-2xl border border-[rgba(255,107,107,0.32)] bg-[rgba(255,107,107,0.12)] p-5 sm:p-6",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"mt-1 flex h-8 w-8 items-center justify-center rounded-full border border-[rgba(255,107,107,0.32)] bg-[rgba(255,107,107,0.18)] text-[#FFD1D1]",children:(0,a.jsx)(h.A,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-base font-semibold text-white",children:"Connection error"}),(0,a.jsx)("p",{className:"text-sm text-[#FFD1D1]",children:M})]})]}),(0,a.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>k(),className:"h-9 rounded-lg border border-[rgba(255,255,255,0.12)] px-4 text-[#FFD1D1] hover:border-[rgba(255,107,107,0.45)] hover:bg-[rgba(255,107,107,0.12)]",children:"Retry"})]})}),(0,a.jsx)("section",{children:(0,a.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4",children:I.map(e=>(0,a.jsx)(f,{...e},e.title))})}),(0,a.jsx)("section",{children:y?(0,a.jsxs)("div",{className:"aurora-card border border-[rgba(255,255,255,0.08)] p-10 text-center text-sm text-[rgba(207,207,207,0.65)]",children:[(0,a.jsx)("p",{className:"text-lg font-medium text-white",children:"Loading subscriptions…"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-[rgba(207,207,207,0.55)]",children:"Fetching the latest customer data. This should only take a moment."})]}):F?(0,a.jsx)("div",{className:"rounded-2xl border border-[rgba(255,107,107,0.32)] bg-[rgba(255,107,107,0.12)] p-5 sm:p-6",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"mt-1 flex h-8 w-8 items-center justify-center rounded-full border border-[rgba(255,107,107,0.32)] bg-[rgba(255,107,107,0.18)] text-[#FFD1D1]",children:(0,a.jsx)(h.A,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-base font-semibold text-white",children:"Error loading subscriptions"}),(0,a.jsx)("p",{className:"text-sm text-[#FFD1D1]",children:F.message})]})]}),(0,a.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>k(),className:"h-9 rounded-lg border border-[rgba(255,255,255,0.12)] px-4 text-[#FFD1D1] hover:border-[rgba(255,107,107,0.45)] hover:bg-[rgba(255,107,107,0.12)]",children:"Retry"})]})}):(0,a.jsx)(U,{subscriptions:(null==w?void 0:w.subscriptions)||[],isLoading:y,total:(null==w?void 0:w.total)||0,currentPage:j,pageSize:p.limit||10,onPageChange:B,onSearch:A,onFilterChange:R,onRefresh:S,onExport:T,onViewUser:L})})]})})})})})}},97155:(e,r,s)=>{Promise.resolve().then(s.bind(s,52079))}},e=>{e.O(0,[5707,4230,1733,6743,2149,2454,6692,1840,5280,8441,1255,7358],()=>e(e.s=97155)),_N_E=e.O()}]);